<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Data Cleaning + EDA - Hurricanes in Atlantic</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Data Cleaning + EDA";
    var mkdocs_page_input_path = "Data_Cleaning_and_EDA.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Hurricanes in Atlantic</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Data Cleaning + EDA</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#dataset-icoads">Dataset ICOADS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#analise-de-dados-faltantes">Análise de dados faltantes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#visualizacao">Visualização</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#agregacao-dos-dados-mdr">Agregação dos Dados MDR</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dataset-hurdat2-hurricane-analise-e-limpeza">Dataset HURDAT2 (Hurricane) - Análise e Limpeza</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#uniao-dos-dados-via-k-nn-ponderado">União dos dados via k-NN ponderado</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#leitura-dos-dados-e-limpezas-adicionais">Leitura dos dados e limpezas adicionais</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#formula-da-distancia">Formula da distância</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#k-nn-ponderado-por-inverso-da-distancia">k-NN ponderado por inverso da distância</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#outras-visualizacoes">Outras Visualizações</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Analises_variaveis/">Destrutividade no curto prazo</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../PowerDissipationIndex/">Destrutividade no longo prazo</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../NN-TrackPrediction/">Prevendo trajetórias</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Hurricanes in Atlantic</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Data Cleaning + EDA</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="exploracao-limpeza-dos-dados-e-visualizacoes">Exploração, Limpeza dos dados e Visualizações</h1>
<p>Trabalharemos com três datasets. O primeiro é um subconjunto do <a href="https://icoads.noaa.gov/">ICOADS</a> (International Comprehensive Ocean-Atmosphere Data Set) fornecido pela <a href="noaa.gov">NOAA</a> (National Oceanic and Atmospheric Administration) que possui vários dados climáticos de cobertura mensal, desde 1800 até o presente, e com abrangência marítima; Possui dados como temperatura do mar, umidade, pressão, cobertura de nuvens, velocidade de vento, etc.</p>
<p>Na célula abaixo, há um código que baixa o subconjunto que usaremos diretamente da fonte oficial. Não colocamos estes arquivos no GitHub por conta do limite de tamanho imposto sobre os uploads/commits.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># !sh ../download_data.sh</span>
</code></pre></div>


<p>O segundo grande conjunto de dados é o <a href="https://www.kaggle.com/noaa/hurricane-database">HURDAT2</a> cuja fonte oficial é a <a href="www.nhc.noaa.gov">NHC</a> (National Hurricane Center), divisão da NOAA responsável pelos furações e tempestades.</p>
<p>Os dados do Kaggle fornecem dados de tempestades e furacões desde o século XIX até 2015 no pacífico e atlântico, mas iremos focar nossa análise no dadaset do atlântico.</p>
<p>O terceiro, é um dado com o índice PDI, mas ele já vem da fonte em boas condições e não necessita de limpeza. Veja mais no notebook <a href="https://github.com/reneroliveira/Hurricane_Project/blob/master/PowerDissipationIndex.ipynb">PowerDissipationIndex.ipynb</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">## Imports</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">c</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span><span class="p">,</span><span class="n">shiftgrid</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">atan2</span><span class="p">,</span> <span class="n">radians</span>

<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">geopy</span>
<span class="kn">import</span> <span class="nn">xarray</span>
<span class="kn">import</span> <span class="nn">networkx</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">tropycal</span>

<span class="kn">import</span> <span class="nn">tropycal.tracks</span> <span class="k">as</span> <span class="nn">tracks</span>
<span class="kn">import</span> <span class="nn">tropycal.tornado</span> <span class="k">as</span> <span class="nn">tornado</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>

<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.api</span> <span class="kn">import</span> <span class="n">OLS</span>
</code></pre></div>


<h2 id="dataset-icoads">Dataset ICOADS</h2>
<p>Vamos analisar os dados baixados acima. O formato .nc é legível ao python através da biblioteca netCDF4 que está nos pré-requisitos. Além disso, serão necessárias instalar os pacotes abaixo; Descomente a célula, execute-a e dê um "Restart Runtime" no Jupyter. Certifique-se que instalou todos os pré-requisitos do arquivo "requirements.txt".</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># !apt-get install libgeos-3.5.0</span>
<span class="c1"># !apt-get install libgeos-dev</span>
<span class="c1"># !pip install https://github.com/matplotlib/basemap/archive/master.zip</span>
</code></pre></div>


<h3 id="analise-de-dados-faltantes">Análise de dados faltantes</h3>
<div class="codehilite"><pre><span></span><code><span class="n">sst_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;../Datasets/sst.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">rhum_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;../Datasets/rhum.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">wspd_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;../Datasets/wspd.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">slp_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;../Datasets/slp.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">vwnd_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;../Datasets/vwnd.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">cldc_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;../Datasets/cldc.mean.nc&quot;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">lats</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][:]</span>

<span class="n">sst</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">][:,:,:]</span>
<span class="n">rhum</span> <span class="o">=</span> <span class="n">rhum_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;rhum&#39;</span><span class="p">][:,:,:]</span>
<span class="n">wspd</span> <span class="o">=</span> <span class="n">wspd_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;wspd&#39;</span><span class="p">][:,:,:]</span>
<span class="n">slp</span> <span class="o">=</span> <span class="n">slp_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;slp&#39;</span><span class="p">][:,:,:]</span>
<span class="n">vwnd</span> <span class="o">=</span> <span class="n">vwnd_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;vwnd&#39;</span><span class="p">][:,:,:]</span>
<span class="n">cldc</span> <span class="o">=</span> <span class="n">cldc_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;cldc&#39;</span><span class="p">][:,:,:]</span>

<span class="n">sst_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">wspd_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">rhum_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">slp_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">vwnd_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">cldc_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1800-01-01&quot;</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2020-07-01&quot;</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_missing</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span><span class="n">labels</span><span class="p">:</span><span class="nb">list</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">:</span>
    <span class="n">missing</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">lenght</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">missing</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenght</span><span class="p">):</span>
            <span class="n">missing</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span><span class="o">/</span><span class="n">item</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">missing</span>

<span class="n">missing</span> <span class="o">=</span> <span class="n">get_missing</span><span class="p">([</span><span class="n">sst</span><span class="p">,</span><span class="n">wspd</span><span class="p">,</span><span class="n">rhum</span><span class="p">,</span><span class="n">slp</span><span class="p">,</span><span class="n">vwnd</span><span class="p">,</span><span class="n">cldc</span><span class="p">],[</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span><span class="s1">&#39;wspd&#39;</span><span class="p">,</span><span class="s1">&#39;rhum&#39;</span><span class="p">,</span><span class="s1">&#39;slp&#39;</span><span class="p">,</span><span class="s1">&#39;vwnd&#39;</span><span class="p">,</span><span class="s1">&#39;cldc&#39;</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Dados Faltantes - Global&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Ano&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% d</span><span class="s2">e dados faltantes&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">missing</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">missing</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/missing-global.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sst</span><span class="p">))</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_7_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="err">&lt;class &#39;numpy.ma.core.MaskedArray&#39;&gt;</span>
</code></pre></div>


<p><strong>Legenda:</strong></p>
<ul>
<li>sst: Sea Surface Temperature (Temperatura na superfície do mar)</li>
<li>wspd: Scalar Wind Speed (Velocidade de vento escalar)</li>
<li>rhum: Relative Humidity (Umidade relativa)</li>
<li>slp: Sea Level Pressure (Pressão no nível do mar)</li>
<li>vwnd: V-wind component (Componente V-wind)</li>
<li>cldc: Cloudiness (Nebulosidade das nuvens)</li>
</ul>
<p>Como os continentes representam aproximadamente <script type="math/tex">29,1\%</script> da suferfície terrestre e nossos dados só preenchem os oceanos, os continentes são preenchidos como dados inexistentes. Então naturalmente nossa cota inferior de dados faltantes é essa porcentagem.</p>
<p>Note que os dados lidos vem no formato de "numpy masked array" que tem um atributo "mask" que é indicadora de dado faltante, isso nos ajudará a lidar com esses dados.</p>
<p>Como vemos no plot acima temos várias décadas com níveis de dados faltantes acima de <script type="math/tex">90\%</script> mas vamos analisar focadamente e atlântico norte, que é nossa região de estudos.</p>
<div class="codehilite"><pre><span></span><code><span class="n">sst_at</span> <span class="o">=</span> <span class="n">sst</span><span class="p">[:,</span><span class="mi">34</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">51</span><span class="p">:</span><span class="mi">82</span><span class="p">]</span> <span class="c1">#10°-20°N, 80°-20°W</span>
<span class="n">wspd_at</span> <span class="o">=</span> <span class="n">wspd</span><span class="p">[:,</span><span class="mi">34</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">51</span><span class="p">:</span><span class="mi">82</span><span class="p">]</span>
<span class="n">rhum_at</span> <span class="o">=</span> <span class="n">rhum</span><span class="p">[:,</span><span class="mi">34</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">51</span><span class="p">:</span><span class="mi">82</span><span class="p">]</span>
<span class="n">slp_at</span> <span class="o">=</span> <span class="n">slp</span><span class="p">[:,</span><span class="mi">34</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">51</span><span class="p">:</span><span class="mi">82</span><span class="p">]</span>
<span class="n">vwnd_at</span> <span class="o">=</span> <span class="n">vwnd</span><span class="p">[:,</span><span class="mi">34</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">51</span><span class="p">:</span><span class="mi">82</span><span class="p">]</span>
<span class="n">cldc_at</span> <span class="o">=</span> <span class="n">cldc</span><span class="p">[:,</span><span class="mi">34</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">51</span><span class="p">:</span><span class="mi">82</span><span class="p">]</span>

<span class="c1"># sst_pac = sst[:,14:45,0:41] #0°-60°N, 100°W-180°W</span>
<span class="c1"># wspd_pac = wspd[:,14:45,0:41]</span>
<span class="c1"># rhum_pac = rhum[:,14:45,0:41]</span>

<span class="n">missing_at</span> <span class="o">=</span> <span class="n">get_missing</span><span class="p">([</span><span class="n">sst_at</span><span class="p">,</span><span class="n">wspd_at</span><span class="p">,</span><span class="n">rhum_at</span><span class="p">,</span><span class="n">slp_at</span><span class="p">,</span><span class="n">vwnd_at</span><span class="p">,</span><span class="n">cldc_at</span><span class="p">],[</span><span class="s1">&#39;sst_at&#39;</span><span class="p">,</span><span class="s1">&#39;wspd_at&#39;</span><span class="p">,</span><span class="s1">&#39;rhum_at&#39;</span><span class="p">,</span><span class="s1">&#39;slp_at&#39;</span><span class="p">,</span><span class="s1">&#39;vwnd_at&#39;</span><span class="p">,</span><span class="s1">&#39;cldc_at&#39;</span><span class="p">])</span>
<span class="c1"># missing_pac = get_missing([sst_pac,wspd_pac,rhum_pac],[&#39;sst_pac&#39;,&#39;wspd_pac&#39;,&#39;rhum_pac&#39;])</span>

<span class="c1"># fig,(ax,ax1) = plt.subplots(2,1,figsize=(10,8))</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Dados Faltantes - Atlântico Norte MDR*&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Ano&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% d</span><span class="s2">e dados faltantes&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">missing_at</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">missing_at</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">period</span><span class="p">[</span><span class="mi">1860</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Jan/1955&quot;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/missing_mdr.png&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_9_0.png" /></p>
<p>*MDR é a abreviação de <em>Main Development Region</em> ou região central de desenvolvimento dos furacões no Atlântico Norte e se refere à faixa 10°-20°N, 80°-20°W.</p>
<p>Vemos que a partir de 1950-1960, os dados começam a ficar mais completos na região de estudos. Então, para entender a relação as variáveis, iremos trabalhar a partir desta data.</p>
<p>Entretanto, nada nos impede de usar os dados mais antigos, já que as medições não variam muito quando estão perto, se quisermos trabalhar com tendências de longo prazo podemos cortar os dados a partir de 1920, trabalhar com a média das regiões estudadas, mesmo que com <script type="math/tex">~70\%</script> de dados faltantes. Isso pois temos a array indicadora, que pode ajudar em modelos, e também essa porcentagem é um pouco mais baixa devido às faixas continentais considaradas no corte de coordenadas.</p>
<p>Abaixo temos um exemplo de como os dados de temperatura estão distribuídos em Janeiro de 1955 </p>
<h3 id="visualizacao">Visualização</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">#Transforms longitude ranges from [0,360] para [-180,180] --&gt; useful for plot</span>

<span class="n">sst</span><span class="p">[:],</span><span class="n">lonsn</span> <span class="o">=</span> <span class="n">shiftgrid</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="n">sst</span><span class="p">[:],</span><span class="n">lons</span><span class="p">,</span><span class="n">start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">wspd</span><span class="p">[:],</span><span class="n">lonsn</span> <span class="o">=</span> <span class="n">shiftgrid</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="n">wspd</span><span class="p">[:],</span><span class="n">lons</span><span class="p">,</span><span class="n">start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># shum[:],lonsn = shiftgrid(180,shum[:],lons,start=False)</span>
<span class="n">rhum</span><span class="p">[:],</span><span class="n">lonsn</span> <span class="o">=</span> <span class="n">shiftgrid</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="n">rhum</span><span class="p">[:],</span><span class="n">lons</span><span class="p">,</span><span class="n">start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">lonsn</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">#Reference: https://annefou.github.io/metos_python/04-plotting/</span>
<span class="n">time_index</span> <span class="o">=</span> <span class="mi">1860</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;sst: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="n">time_index</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="nb">map</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;cyl&#39;</span><span class="p">,</span><span class="n">llcrnrlat</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span><span class="n">urcrnrlat</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>\
            <span class="n">llcrnrlon</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span><span class="n">urcrnrlon</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
<span class="nb">map</span><span class="o">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ffe2ab&#39;</span><span class="p">)</span>

<span class="nb">map</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">90.</span><span class="p">,</span><span class="mf">120.</span><span class="p">,</span><span class="mf">30.</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">map</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">180.</span><span class="p">,</span><span class="mf">180.</span><span class="p">,</span><span class="mf">60.</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>


<span class="n">llons</span><span class="p">,</span> <span class="n">llats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">llons</span><span class="p">,</span><span class="n">llats</span><span class="p">)</span>


<span class="n">cmap</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;#35978f&#39;</span><span class="p">,</span><span class="s1">&#39;#ffffcc&#39;</span><span class="p">,</span><span class="s1">&#39;#ffeda0&#39;</span><span class="p">,</span><span class="s1">&#39;#fed976&#39;</span><span class="p">,</span><span class="s1">&#39;#feb24c&#39;</span><span class="p">,</span><span class="s1">&#39;#fd8d3c&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;#fc4e2a&#39;</span><span class="p">,</span><span class="s1">&#39;#e31a1c&#39;</span><span class="p">,</span><span class="s1">&#39;#bd0026&#39;</span><span class="p">,</span><span class="s1">&#39;#800026&#39;</span><span class="p">])</span>
<span class="n">bounds</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># bounds=list(np.arange(10,100,5))</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">cs</span> <span class="o">=</span> <span class="nb">map</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">sst</span><span class="p">[</span><span class="n">time_index</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/sst_1955.png&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_13_0.png" /></p>
<h3 id="agregacao-dos-dados-mdr">Agregação dos Dados MDR</h3>
<p>Criaremos a seguir uma dataframe com as médias espaciais da região MDR, para análise futura com o PDI. Usamos essa média baseados na premissa razoável de que nesse corte espacial da MDR do atlântico os valores não variam muito dentro de um mês. Fazemos essa médias para análises de mais longo prazo como podem ver no notebook do <a href="https://github.com/reneroliveira/Hurricane_Project/blob/master/PowerDissipationIndex.ipynb">PDI</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">1860</span><span class="p">])</span> <span class="c1"># -- Jan/1955</span>
<span class="k">def</span> <span class="nf">get_mean</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]))</span>
    <span class="k">return</span> <span class="n">new</span>

<span class="c1">#Começaremos do índice 1788, representando Janeiro de 1949, para corresponder com os dados de PDI.</span>
<span class="n">data_at</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">get_mean</span><span class="p">(</span><span class="n">sst_at</span><span class="p">[</span><span class="mi">1788</span><span class="p">:,:,:]),</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;sst&quot;</span><span class="p">])</span>
<span class="n">period_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">1788</span><span class="p">:],</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">])</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">period_df</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">period_df</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
<span class="n">data_at</span><span class="p">[</span><span class="s1">&#39;rhum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">get_mean</span><span class="p">(</span><span class="n">rhum_at</span><span class="p">[</span><span class="mi">1788</span><span class="p">:,:,:]),</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;rhum&quot;</span><span class="p">])</span>
<span class="n">data_at</span><span class="p">[</span><span class="s1">&#39;slp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">get_mean</span><span class="p">(</span><span class="n">slp_at</span><span class="p">[</span><span class="mi">1788</span><span class="p">:,:,:]),</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;slp&quot;</span><span class="p">])</span>
<span class="n">data_at</span><span class="p">[</span><span class="s1">&#39;wspd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">get_mean</span><span class="p">(</span><span class="n">wspd_at</span><span class="p">[</span><span class="mi">1788</span><span class="p">:,:,:]),</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;wspd&quot;</span><span class="p">])</span>
<span class="n">data_at</span><span class="p">[</span><span class="s1">&#39;vwnd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">get_mean</span><span class="p">(</span><span class="n">vwnd_at</span><span class="p">[</span><span class="mi">1788</span><span class="p">:,:,:]),</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;vwnd&quot;</span><span class="p">])</span>
<span class="n">data_at</span><span class="p">[</span><span class="s1">&#39;cldc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">get_mean</span><span class="p">(</span><span class="n">cldc_at</span><span class="p">[</span><span class="mi">1788</span><span class="p">:,:,:]),</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;cldc&quot;</span><span class="p">])</span>

<span class="n">atlantic_mdr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">period_df</span><span class="p">,</span><span class="n">data_at</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="c1">#Código que calcula desvios da temperatura do mar em relação à média histórica</span>
<span class="c1">#Apenas para visualização</span>
<span class="n">cum_sum</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
    <span class="n">cum_sum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">k</span><span class="o">=</span><span class="mi">0</span> <span class="c1">#year count</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">month</span> <span class="o">=</span> <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">Month</span>
    <span class="k">if</span> <span class="n">month</span><span class="o">%</span><span class="mi">12</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">cum_sum</span><span class="p">[</span><span class="n">month</span><span class="p">]</span><span class="o">+=</span><span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;sst_anomaly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">cum_sum</span><span class="p">[</span><span class="n">month</span><span class="p">]</span><span class="o">/</span><span class="n">k</span>
<span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;sst_anomaly&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../Datasets/atlantic_mdr.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">24</span><span class="p">,:]</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">1955-01-01 00:00:00</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Year</th>
      <th>Month</th>
      <th>sst</th>
      <th>rhum</th>
      <th>slp</th>
      <th>wspd</th>
      <th>vwnd</th>
      <th>cldc</th>
      <th>sst_anomaly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>1950-01-01</td>
      <td>1950</td>
      <td>1</td>
      <td>24.782794</td>
      <td>75.675756</td>
      <td>1012.699219</td>
      <td>7.800527</td>
      <td>-2.709708</td>
      <td>4.139401</td>
      <td>-0.138282</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1950-02-01</td>
      <td>1950</td>
      <td>2</td>
      <td>24.251776</td>
      <td>78.633936</td>
      <td>1012.883875</td>
      <td>6.583213</td>
      <td>-2.401613</td>
      <td>3.965875</td>
      <td>-0.129778</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1950-03-01</td>
      <td>1950</td>
      <td>3</td>
      <td>24.395219</td>
      <td>78.334148</td>
      <td>1013.134516</td>
      <td>6.621354</td>
      <td>-2.062759</td>
      <td>4.087092</td>
      <td>-0.020090</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1950-04-01</td>
      <td>1950</td>
      <td>4</td>
      <td>24.900423</td>
      <td>77.248673</td>
      <td>1011.096354</td>
      <td>5.958877</td>
      <td>-0.454326</td>
      <td>3.146995</td>
      <td>-0.010952</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1950-05-01</td>
      <td>1950</td>
      <td>5</td>
      <td>25.355377</td>
      <td>79.638362</td>
      <td>1010.577563</td>
      <td>6.486837</td>
      <td>0.516981</td>
      <td>4.291411</td>
      <td>-0.061999</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1950-06-01</td>
      <td>1950</td>
      <td>6</td>
      <td>26.110960</td>
      <td>81.022388</td>
      <td>1009.393293</td>
      <td>6.946026</td>
      <td>2.076482</td>
      <td>4.650387</td>
      <td>0.087756</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1950-07-01</td>
      <td>1950</td>
      <td>7</td>
      <td>26.516357</td>
      <td>80.354432</td>
      <td>1007.978285</td>
      <td>6.342278</td>
      <td>2.375750</td>
      <td>5.184904</td>
      <td>-0.070533</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1950-08-01</td>
      <td>1950</td>
      <td>8</td>
      <td>27.312561</td>
      <td>81.914887</td>
      <td>1007.856950</td>
      <td>5.279884</td>
      <td>1.956808</td>
      <td>5.109233</td>
      <td>-0.081636</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1950-09-01</td>
      <td>1950</td>
      <td>9</td>
      <td>27.811223</td>
      <td>80.212305</td>
      <td>1007.869104</td>
      <td>4.947030</td>
      <td>0.525868</td>
      <td>5.305648</td>
      <td>-0.057075</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1950-10-01</td>
      <td>1950</td>
      <td>10</td>
      <td>27.702060</td>
      <td>80.523185</td>
      <td>1010.697798</td>
      <td>4.656318</td>
      <td>-1.037250</td>
      <td>4.423469</td>
      <td>-0.026328</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1950-11-01</td>
      <td>1950</td>
      <td>11</td>
      <td>27.303333</td>
      <td>81.614127</td>
      <td>1009.745018</td>
      <td>5.103683</td>
      <td>-2.024746</td>
      <td>3.765682</td>
      <td>0.058410</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1950-12-01</td>
      <td>1950</td>
      <td>12</td>
      <td>26.351468</td>
      <td>77.828336</td>
      <td>1012.071718</td>
      <td>5.696333</td>
      <td>-4.750430</td>
      <td>4.100716</td>
      <td>0.117639</td>
    </tr>
  </tbody>
</table>
</div>

<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1949</span><span class="p">,</span><span class="mi">2021</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;sst_anomaly&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})[</span><span class="s1">&#39;sst_anomaly&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Desvios na temperatura do mar em relação à média histórica&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Ano&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Desvio da temperatura&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_16_0.png" /></p>
<p>Podemos ver que após 1970-1980 inicia-se uma tendência crescente de aumento de temperatura do mar em relação à média histórica.</p>
<div class="codehilite"><pre><span></span><code><span class="n">corr</span> <span class="o">=</span> <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">corr</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
</code></pre></div>


<style  type="text/css" >
    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col0 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col1 {
            background-color:  #9dbdff;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col2 {
            background-color:  #d6dce4;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col3 {
            background-color:  #b9d0f9;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col4 {
            background-color:  #d6dce4;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col5 {
            background-color:  #f4987a;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col6 {
            background-color:  #c9d7f0;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col7 {
            background-color:  #dfdbd9;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col8 {
            background-color:  #bcd2f7;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col0 {
            background-color:  #536edd;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col1 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col2 {
            background-color:  #e36b54;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col3 {
            background-color:  #f7ba9f;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col4 {
            background-color:  #7ea1fa;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col5 {
            background-color:  #4055c8;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col6 {
            background-color:  #e5d8d1;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col7 {
            background-color:  #f2cbb7;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col8 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col0 {
            background-color:  #82a6fb;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col1 {
            background-color:  #e7745b;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col2 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col3 {
            background-color:  #ee8669;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col4 {
            background-color:  #5977e3;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col5 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col6 {
            background-color:  #f7b194;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col7 {
            background-color:  #f7a688;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col8 {
            background-color:  #a7c5fe;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col0 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col1 {
            background-color:  #eed0c0;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col2 {
            background-color:  #f18f71;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col3 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col4 {
            background-color:  #4257c9;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col5 {
            background-color:  #4257c9;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col6 {
            background-color:  #d85646;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col7 {
            background-color:  #ead5c9;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col8 {
            background-color:  #445acc;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col0 {
            background-color:  #6485ec;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col1 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col2 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col3 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col4 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col5 {
            background-color:  #e1dad6;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col6 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col7 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col8 {
            background-color:  #6788ee;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col0 {
            background-color:  #f7b497;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col1 {
            background-color:  #445acc;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col2 {
            background-color:  #6384eb;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col3 {
            background-color:  #82a6fb;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col4 {
            background-color:  #f4c5ad;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col5 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col6 {
            background-color:  #a1c0ff;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col7 {
            background-color:  #b2ccfb;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col8 {
            background-color:  #4b64d5;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col0 {
            background-color:  #4b64d5;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col1 {
            background-color:  #c3d5f4;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col2 {
            background-color:  #f6bda2;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col3 {
            background-color:  #d95847;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col4 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col5 {
            background-color:  #5e7de7;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col6 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col7 {
            background-color:  #dedcdb;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col8 {
            background-color:  #3e51c5;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col0 {
            background-color:  #a2c1ff;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col1 {
            background-color:  #edd2c3;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col2 {
            background-color:  #f6a283;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col3 {
            background-color:  #f2c9b4;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col4 {
            background-color:  #688aef;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col5 {
            background-color:  #9ebeff;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col6 {
            background-color:  #efcfbf;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col7 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col8 {
            background-color:  #455cce;
            color:  #f1f1f1;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col0 {
            background-color:  #cbd8ee;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col1 {
            background-color:  #9bbcff;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col2 {
            background-color:  #efcfbf;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col3 {
            background-color:  #cdd9ec;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col4 {
            background-color:  #e2dad5;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col5 {
            background-color:  #a6c4fe;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col6 {
            background-color:  #cedaeb;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col7 {
            background-color:  #b5cdfa;
            color:  #000000;
        }    #T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col8 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }</style>

<table id="T_f64d8f40_eb28_11ea_88a4_cdafc426433b" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Year</th>        <th class="col_heading level0 col1" >Month</th>        <th class="col_heading level0 col2" >sst</th>        <th class="col_heading level0 col3" >rhum</th>        <th class="col_heading level0 col4" >slp</th>        <th class="col_heading level0 col5" >wspd</th>        <th class="col_heading level0 col6" >vwnd</th>        <th class="col_heading level0 col7" >cldc</th>        <th class="col_heading level0 col8" >sst_anomaly</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row0" class="row_heading level0 row0" >Year</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col0" class="data row0 col0" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col1" class="data row0 col1" >-0.010203</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col2" class="data row0 col2" >0.145686</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col3" class="data row0 col3" >-0.098235</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col4" class="data row0 col4" >0.048908</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col5" class="data row0 col5" >0.646453</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col6" class="data row0 col6" >-0.035567</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col7" class="data row0 col7" >0.241832</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow0_col8" class="data row0 col8" >0.379038</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row1" class="row_heading level0 row1" >Month</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col0" class="data row1 col0" >-0.010203</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col1" class="data row1 col1" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col2" class="data row1 col2" >0.762722</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col3" class="data row1 col3" >0.392842</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col4" class="data row1 col4" >-0.434216</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col5" class="data row1 col5" >-0.385048</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col6" class="data row1 col6" >0.151316</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col7" class="data row1 col7" >0.380311</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow1_col8" class="data row1 col8" >-0.017207</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row2" class="row_heading level0 row2" >sst</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col0" class="data row2 col0" >0.145686</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col1" class="data row2 col1" >0.762722</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col2" class="data row2 col2" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col3" class="data row2 col3" >0.635370</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col4" class="data row2 col4" >-0.632031</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col5" class="data row2 col5" >-0.416486</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col6" class="data row2 col6" >0.432498</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col7" class="data row2 col7" >0.559898</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow2_col8" class="data row2 col8" >0.312656</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row3" class="row_heading level0 row3" >rhum</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col0" class="data row3 col0" >-0.098235</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col1" class="data row3 col1" >0.392842</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col2" class="data row3 col2" >0.635370</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col3" class="data row3 col3" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col4" class="data row3 col4" >-0.768182</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col5" class="data row3 col5" >-0.380635</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col6" class="data row3 col6" >0.803748</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col7" class="data row3 col7" >0.305508</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow3_col8" class="data row3 col8" >0.014696</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row4" class="row_heading level0 row4" >slp</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col0" class="data row4 col0" >0.048908</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col1" class="data row4 col1" >-0.434216</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col2" class="data row4 col2" >-0.632031</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col3" class="data row4 col3" >-0.768182</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col4" class="data row4 col4" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col5" class="data row4 col5" >0.317397</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col6" class="data row4 col6" >-0.812037</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col7" class="data row4 col7" >-0.548567</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow4_col8" class="data row4 col8" >0.129542</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row5" class="row_heading level0 row5" >wspd</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col0" class="data row5 col0" >0.646453</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col1" class="data row5 col1" >-0.385048</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col2" class="data row5 col2" >-0.416486</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col3" class="data row5 col3" >-0.380635</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col4" class="data row5 col4" >0.317397</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col5" class="data row5 col5" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col6" class="data row5 col6" >-0.253309</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col7" class="data row5 col7" >0.007404</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow5_col8" class="data row5 col8" >0.040588</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row6" class="row_heading level0 row6" >vwnd</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col0" class="data row6 col0" >-0.035567</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col1" class="data row6 col1" >0.151316</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col2" class="data row6 col2" >0.432498</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col3" class="data row6 col3" >0.803748</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col4" class="data row6 col4" >-0.812037</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col5" class="data row6 col5" >-0.253309</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col6" class="data row6 col6" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col7" class="data row6 col7" >0.236100</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow6_col8" class="data row6 col8" >-0.002599</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row7" class="row_heading level0 row7" >cldc</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col0" class="data row7 col0" >0.241832</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col1" class="data row7 col1" >0.380311</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col2" class="data row7 col2" >0.559898</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col3" class="data row7 col3" >0.305508</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col4" class="data row7 col4" >-0.548567</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col5" class="data row7 col5" >0.007404</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col6" class="data row7 col6" >0.236100</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col7" class="data row7 col7" >1.000000</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow7_col8" class="data row7 col8" >0.019122</td>
            </tr>
            <tr>
                        <th id="T_f64d8f40_eb28_11ea_88a4_cdafc426433blevel0_row8" class="row_heading level0 row8" >sst_anomaly</th>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col0" class="data row8 col0" >0.379038</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col1" class="data row8 col1" >-0.017207</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col2" class="data row8 col2" >0.312656</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col3" class="data row8 col3" >0.014696</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col4" class="data row8 col4" >0.129542</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col5" class="data row8 col5" >0.040588</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col6" class="data row8 col6" >-0.002599</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col7" class="data row8 col7" >0.019122</td>
                        <td id="T_f64d8f40_eb28_11ea_88a4_cdafc426433brow8_col8" class="data row8 col8" >1.000000</td>
            </tr>
    </tbody></table>

<p>Alguma correlações fortes interessantes:</p>
<ul>
<li>Temperatura do mar (sst) com ano (Year)</li>
<li>Temperatura do mar (sst) e umidade (rhum)</li>
<li>Velocidade de vento (wspd) e ano (Year)</li>
<li>Pressão (slp) e Umidade (rhum)</li>
</ul>
<p>Análises mais aprofundadas dessas variáveis veremos no notebook de análise do PDI. </p>
<div class="codehilite"><pre><span></span><code><span class="n">month_sst</span> <span class="o">=</span> <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)[</span><span class="s1">&#39;sst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">month_rhum</span> <span class="o">=</span> <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)[</span><span class="s1">&#39;rhum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1"># month_slp = atlantic_mdr.groupby(&#39;Month&#39;)[&#39;slp&#39;].mean()</span>
<span class="c1"># month_cldc = atlantic_mdr.groupby(&#39;Month&#39;)[&#39;cldc&#39;].mean()</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">month_sst</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;sst&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Mês&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Média Histórica - SST&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">month_rhum</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;rhum&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Média Histórica - Umidade&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../figs/mensal_sst_rhum.jpg&quot;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_20_0.png" /></p>
<p>Veja acima que os picos de temperatura e umidade, coincidem razoavelmente com a temporada de furacões.</p>
<div class="codehilite"><pre><span></span><code><span class="n">month_slp</span> <span class="o">=</span> <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)[</span><span class="s1">&#39;slp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">month_cldc</span> <span class="o">=</span> <span class="n">atlantic_mdr</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)[</span><span class="s1">&#39;cldc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">month_slp</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;slp&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Mês&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Média Histórica - Pressão&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">month_cldc</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;cldc&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Média Histórica - Nebulosidade&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../figs/mensal_slp_cldc.jpg&quot;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_22_0.png" /></p>
<p>O pico de nebulosidade das nuvens também coincide de forma razoável com a temporada de furacões. Assim como os valores mais baixos de pressão. Essas características estão relacionadas com a formação do evento de tempestade forte ou furacão.</p>
<h2 id="dataset-hurdat2-hurricane-analise-e-limpeza">Dataset HURDAT2 (Hurricane) - Análise e Limpeza</h2>
<p>Passemos agora a analisar os dados de tempestades e furacões.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># O foco principal do trabalho se dará nos dados do atlântico</span>
<span class="n">data_atl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Datasets/atlantic.csv&#39;</span><span class="p">,</span><span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">data_atl</span><span class="o">.</span><span class="n">dtypes</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">ID</span><span class="w">                          </span><span class="k">object</span><span class="w"></span>
<span class="n">Name</span><span class="w">                        </span><span class="k">object</span><span class="w"></span>
<span class="nc">Date</span><span class="w">                </span><span class="n">datetime64</span><span class="o">[</span><span class="n">ns</span><span class="o">]</span><span class="w"></span>
<span class="nc">Time</span><span class="w">                         </span><span class="n">int64</span><span class="w"></span>
<span class="n">Event</span><span class="w">                       </span><span class="k">object</span><span class="w"></span>
<span class="n">Status</span><span class="w">                      </span><span class="k">object</span><span class="w"></span>
<span class="n">Latitude</span><span class="w">                    </span><span class="k">object</span><span class="w"></span>
<span class="n">Longitude</span><span class="w">                   </span><span class="k">object</span><span class="w"></span>
<span class="n">Maximum</span><span class="w"> </span><span class="n">Wind</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">Minimum</span><span class="w"> </span><span class="n">Pressure</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NE</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SE</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SW</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NW</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NE</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SE</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SW</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NW</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NE</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SE</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SW</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NW</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="nl">dtype</span><span class="p">:</span><span class="w"> </span><span class="k">object</span><span class="w"></span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># formatando dados de data</span>
<span class="n">data_atl</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data_atl</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">year</span>
<span class="n">data_atl</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data_atl</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">month</span>
<span class="n">data_atl</span><span class="p">[</span><span class="s1">&#39;Day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data_atl</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">day</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_atl</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">data_atl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">Index([&#39;ID&#39;, &#39;Name&#39;, &#39;Date&#39;, &#39;Time&#39;, &#39;Event&#39;, &#39;Status&#39;, &#39;Latitude&#39;,</span>
<span class="err">       &#39;Longitude&#39;, &#39;Maximum Wind&#39;, &#39;Minimum Pressure&#39;, &#39;Low Wind NE&#39;,</span>
<span class="err">       &#39;Low Wind SE&#39;, &#39;Low Wind SW&#39;, &#39;Low Wind NW&#39;, &#39;Moderate Wind NE&#39;,</span>
<span class="err">       &#39;Moderate Wind SE&#39;, &#39;Moderate Wind SW&#39;, &#39;Moderate Wind NW&#39;,</span>
<span class="err">       &#39;High Wind NE&#39;, &#39;High Wind SE&#39;, &#39;High Wind SW&#39;, &#39;High Wind NW&#39;, &#39;Year&#39;,</span>
<span class="err">       &#39;Month&#39;, &#39;Day&#39;],</span>
<span class="err">      dtype=&#39;object&#39;)</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Date</th>
      <th>Time</th>
      <th>Event</th>
      <th>Status</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Maximum Wind</th>
      <th>Minimum Pressure</th>
      <th>...</th>
      <th>Moderate Wind SE</th>
      <th>Moderate Wind SW</th>
      <th>Moderate Wind NW</th>
      <th>High Wind NE</th>
      <th>High Wind SE</th>
      <th>High Wind SW</th>
      <th>High Wind NW</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL011851</td>
      <td>UNNAMED</td>
      <td>1851-06-25</td>
      <td>0</td>
      <td></td>
      <td>HU</td>
      <td>28.0N</td>
      <td>94.8W</td>
      <td>80</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1851</td>
      <td>6</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL011851</td>
      <td>UNNAMED</td>
      <td>1851-06-25</td>
      <td>600</td>
      <td></td>
      <td>HU</td>
      <td>28.0N</td>
      <td>95.4W</td>
      <td>80</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1851</td>
      <td>6</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL011851</td>
      <td>UNNAMED</td>
      <td>1851-06-25</td>
      <td>1200</td>
      <td></td>
      <td>HU</td>
      <td>28.0N</td>
      <td>96.0W</td>
      <td>80</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1851</td>
      <td>6</td>
      <td>25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL011851</td>
      <td>UNNAMED</td>
      <td>1851-06-25</td>
      <td>1800</td>
      <td></td>
      <td>HU</td>
      <td>28.1N</td>
      <td>96.5W</td>
      <td>80</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1851</td>
      <td>6</td>
      <td>25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL011851</td>
      <td>UNNAMED</td>
      <td>1851-06-25</td>
      <td>2100</td>
      <td>L</td>
      <td>HU</td>
      <td>28.2N</td>
      <td>96.8W</td>
      <td>80</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1851</td>
      <td>6</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>

<div class="codehilite"><pre><span></span><code><span class="c1"># Registro de Furacões é maior em determinada época do ano</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_atl</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">Month</span>
<span class="err">1       132</span>
<span class="err">2        13</span>
<span class="err">3        14</span>
<span class="err">4        81</span>
<span class="err">5       655</span>
<span class="err">6      2349</span>
<span class="err">7      3262</span>
<span class="err">8     10857</span>
<span class="err">9     18926</span>
<span class="err">10     9802</span>
<span class="err">11     2548</span>
<span class="err">12      466</span>
<span class="c">Name: ID, dtype: int64</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Número de furações registrados por mês do ano&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.06</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">data_atl</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">])[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de registros (1851-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Mês$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Quantidade$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># ax.legend(loc=&#39;best&#39;, fontsize=12);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../figs/furacoes_mes.jpg&quot;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_28_0.png" /></p>
<p>Período de furacões se concentra entre os meses de julho e novembro.
Isso deve estar relacionado com o período anterior (verão do hemisfério norte, onde acontece o maior número de casos)
O aquecimento das águas está intimamente ligado com a formação das massas de ar que ocasionam os furacões
Isso nos dá uma pista da forma de correlação temporal que devemos buscar para predizer os eventos</p>
<div class="codehilite"><pre><span></span><code><span class="c1">## Formatação dos dados para plot pressao x vento</span>
<span class="n">data_atl_ext</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_atl_mwmp</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_atl_mw</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">ind_nan_ext</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ind_nan_mwmp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ind_nan_mw</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">data_atl_mw</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">ind_nan_mw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">ind_nan_mwmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">ind_nan_ext</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">data_atl_mwmp</span><span class="p">[</span><span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">ind_nan_mwmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">ind_nan_ext</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Low Wind NE&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Low Wind SE&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span>
              <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Low Wind SW&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Low Wind NW&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> 
              <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Moderate Wind NE&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Moderate Wind SE&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span>
              <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Moderate Wind SW&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;Moderate Wind NW&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> 
              <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;High Wind NE&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;High Wind SE&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span>
              <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;High Wind SW&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">data_atl_ext</span><span class="p">[</span><span class="s1">&#39;High Wind NW&#39;</span><span class="p">][</span><span class="n">l</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">ind_nan_ext</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">data_atl_ext</span> <span class="o">=</span> <span class="n">data_atl_ext</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ind_nan_ext</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data_atl_mwmp</span> <span class="o">=</span> <span class="n">data_atl_mwmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ind_nan_mwmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data_atl_mw</span> <span class="o">=</span> <span class="n">data_atl_mw</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ind_nan_mw</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_ext</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_mwmp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">---------------------------------------------------------------------------</span>

<span class="n">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="k">call</span> <span class="k">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="k">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">754270</span><span class="n">ff204f</span><span class="o">&gt;</span> <span class="k">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="mi">1</span> <span class="o">##</span> <span class="n">Formatação</span> <span class="n">dos</span> <span class="n">dados</span> <span class="n">para</span> <span class="n">plot</span> <span class="n">pressao</span> <span class="n">x</span> <span class="n">vento</span>
<span class="c1">----&gt; 2 data_atl_ext = data_atl.copy()</span>
      <span class="mi">3</span> <span class="n">data_atl_mwmp</span> <span class="o">=</span> <span class="n">data_atl</span><span class="p">.</span><span class="k">copy</span><span class="p">()</span>
      <span class="mi">4</span> <span class="n">data_atl_mw</span> <span class="o">=</span> <span class="n">data_atl</span><span class="p">.</span><span class="k">copy</span><span class="p">()</span>
      <span class="mi">5</span>


<span class="n">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;data_atl&#39;</span> <span class="k">is</span> <span class="k">not</span> <span class="k">defined</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="c1">#fig.suptitle(&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;, fontsize=28, y=1.06)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_atl_mwmp</span><span class="p">[</span><span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">],</span> <span class="n">data_atl_mwmp</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Pressão Mínima$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Velocidade Máxima$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># ax.legend(loc=&#39;best&#39;, fontsize=12);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/pressaoMin_Velo_max.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_31_0.png" /></p>
<p>Abaixo formatamos as Latitudes e Longitudes para remover os terminadores W, E, N e S. Como indicador de hemisfério, usamos sinal negativo para sul e oeste e positovo para norte e leste. Precisaremos que esses dados sejam numericos para aplicações futuras e não textuais.</p>
<div class="codehilite"><pre><span></span><code><span class="n">data_atl</span><span class="p">[[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dtypes</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">Latitude     object</span>
<span class="err">Longitude    object</span>
<span class="c">dtype: object</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data_atl</span><span class="o">.</span><span class="n">Latitude</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">Latitude</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">)))</span>
<span class="n">data_atl</span><span class="o">.</span><span class="n">Longitude</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">Longitude</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">)))</span>
<span class="n">data_atl</span><span class="p">[[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>49105.000000</td>
      <td>49105.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>27.044904</td>
      <td>-65.682533</td>
    </tr>
    <tr>
      <th>std</th>
      <td>10.077880</td>
      <td>19.687240</td>
    </tr>
    <tr>
      <th>min</th>
      <td>7.200000</td>
      <td>-359.100000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>19.100000</td>
      <td>-81.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>26.400000</td>
      <td>-68.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>33.100000</td>
      <td>-52.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>81.000000</td>
      <td>63.000000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="codehilite"><pre><span></span><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#print(f&#39;R^2_test  = {r2_test}&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_const  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Year  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">w0</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1850</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2015</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_atl</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2015</span><span class="p">],</span> <span class="p">[</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">],</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de Furacões Anuais (1851-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Quantidade$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># ax.legend(loc=&#39;best&#39;, fontsize=12);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/numero_furacoes1851-2015.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.40918060978409</span>
<span class="err">Parâmetro_const  = -3940.349139351199</span>
<span class="err">Parâmetro_Year  = 2.192423797184304</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_35_1.png" /></p>
<p>Vemos acima que o número de registro de furações tem crescido desde 1850, mas isso se deve à maior capacidade de detecção com o passar dos anos.</p>
<div class="codehilite"><pre><span></span><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_mw</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data_atl_mw</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_const  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Year  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">w0</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1850</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2015</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_atl_mw</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">data_atl_mw</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2015</span><span class="p">],</span> <span class="p">[</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">],</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Velocidade Máxima vs Ano (1851-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Velocidade Máxima$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>


<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/maxwind_1851-2015.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.49772308255924613</span>
<span class="err">Parâmetro_const  = 345.3529584491673</span>
<span class="err">Parâmetro_Year  = -0.15025433346159078</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_37_1.png" /></p>
<p>Vemos também que a velocidade máxima de vento sustentada pelos furacões reduziu, mas isso também se deve à maior capacidade de registro de eventos de pequeno porte, que acabam pesando a média para baixo. Assim, para não enviesar nossos dados, filtraremos os registros de pequeno porte; Consideramos apenas tempestades cuja duração em dias é maior que 2, e cuja classificação na escala <a href="https://en.wikipedia.org/wiki/Saffir%E2%80%93Simpson_scale">Saffir-Simpson</a> seja no mínimo Tempestade Tropical.</p>
<p>Para essa classificação, a velocidade máxima sustentada de vento deve ultrapassar 63km/h o que equivale a 34 knots (milhas náuticas).</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#Filtro de Duração</span>
<span class="n">data_atl_fdur</span> <span class="o">=</span> <span class="n">data_atl_mw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">duration</span> <span class="o">=</span> <span class="n">data_atl_mw</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">data_atl_mw</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">duration</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Duration&#39;</span>
<span class="c1">#print(duration)</span>
<span class="n">data_atl_fdur</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_atl_fdur</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_atl_fdur</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data_atl_fdur</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">downcast</span><span class="o">=</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<span class="n">data_atl_fdur</span> <span class="o">=</span> <span class="n">data_atl_fdur</span><span class="p">[</span><span class="n">data_atl_fdur</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_fdur</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">46350</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">#Filtro de Max_Windspeed</span>
<span class="n">data_atl_fwind</span> <span class="o">=</span> <span class="n">data_atl_fdur</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_atl_fwind</span> <span class="o">=</span> <span class="n">data_atl_fwind</span><span class="p">[</span><span class="n">data_atl_fwind</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">34</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_fwind</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">35696</span>
</code></pre></div>


<p>Vejamos os novos plots com os dados filtrados:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Com o novo filtro, o viés do aumento no número de furacões ao longo dos anos reduziu, mas ainda há um aumento</span>
<span class="c1"># Isso mostra que essa tendência pode ser algo não viesada, e que gera preocupação pelo futuro</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_fwind</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data_atl_fwind</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> 
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#print(f&#39;R^2_test  = {r2_test}&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_const  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Year  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">w0</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1850</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2015</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_atl_fwind</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2015</span><span class="p">],</span> <span class="p">[</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">],</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de Furacões Anuais (1851-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Quantidade$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>


<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/filtered_numero_furacoes1851-2015.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.15573477903937427</span>
<span class="err">Parâmetro_const  = -1661.4327723310091</span>
<span class="err">Parâmetro_Year  = 0.9714289530628057</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_42_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_fwind</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data_atl_fwind</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#print(f&#39;R^2_test  = {r2_test}&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_const  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Year  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">w0</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1850</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2015</span><span class="o">*</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_atl_fwind</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">data_atl_fwind</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2015</span><span class="p">],</span> <span class="p">[</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">],</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Velocidade Máxima vs Ano (1851-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Velocidade Máxima$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/filtered_maxwind_1851-2015.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.11158706746149893</span>
<span class="err">Parâmetro_const  = 167.44362825887208</span>
<span class="err">Parâmetro_Year  = -0.05470982174808241</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_43_1.png" /></p>
<p>Com o novo filtro, o viés da redução da velocidade máxima sustentada de vento reduziu, quase para o nível constante
Isso pode significar que os filtros estão relativamente bem adequados para retirada do viés inicial dos dados.</p>
<p>Geraremos então um novo DataFrame com algums filtros importantes:</p>
<ul>
<li>Velocidade Máxima Sustentada &gt; 34 milhas náuticas</li>
<li>Duração &gt; 2 dias</li>
<li>Furacões a partir de 1950 (quando a capacidade de medição começa a evoluir</li>
</ul>
<p>O código abaixo aplica esses filtros.</p>
<div class="codehilite"><pre><span></span><code><span class="n">data_atl_mw2</span> <span class="o">=</span> <span class="n">data_atl</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">data_atl_mw2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">Lat_min</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">Lat_min</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Lat_min&#39;</span>

<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">,</span> <span class="n">Lat_min</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="s1">&#39;Lat_min&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">12.5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>


<span class="n">Lon_min</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">Lon_min</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Lon_min&#39;</span>

<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">,</span> <span class="n">Lon_min</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#print(data_atl_mw2_filtrado3)</span>
<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="s1">&#39;Lon_min&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">180</span><span class="p">]</span>

<span class="n">Wind_max</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">Wind_max</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Wind_max&#39;</span>
<span class="c1">#print(Wind_max)</span>
<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">,</span> <span class="n">Wind_max</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">)</span><span class="c1">#left_on=&#39;ID&#39;, right_index=True)</span>
<span class="c1">#print(data_atl_mw2_filtrado3)</span>
<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="s1">&#39;Wind_max&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">34</span><span class="p">]</span>

<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1950</span><span class="p">]</span>

<span class="n">duration</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">duration</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Duration&#39;</span>
<span class="c1">#print(duration)</span>
<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">downcast</span><span class="o">=</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Lat_min&#39;</span><span class="p">,</span> <span class="s1">&#39;Lon_min&#39;</span><span class="p">,</span> <span class="s1">&#39;Wind_max&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#data_atl_mw2_filtrado3.head()</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">])[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_atl_mw2</span><span class="p">))</span>
<span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">22386</span>
<span class="err">1814</span>
<span class="err">685</span>
<span class="err">49105</span>
<span class="err">49105</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Date</th>
      <th>Time</th>
      <th>Event</th>
      <th>Status</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Maximum Wind</th>
      <th>Minimum Pressure</th>
      <th>...</th>
      <th>Moderate Wind SW</th>
      <th>Moderate Wind NW</th>
      <th>High Wind NE</th>
      <th>High Wind SE</th>
      <th>High Wind SW</th>
      <th>High Wind NW</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21948</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-02</td>
      <td>1200</td>
      <td></td>
      <td>EX</td>
      <td>30.5</td>
      <td>-58.0</td>
      <td>50</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1951</td>
      <td>1</td>
      <td>2</td>
      <td>10</td>
    </tr>
    <tr>
      <th>21949</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-02</td>
      <td>1800</td>
      <td></td>
      <td>EX</td>
      <td>29.9</td>
      <td>-56.8</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1951</td>
      <td>1</td>
      <td>2</td>
      <td>10</td>
    </tr>
    <tr>
      <th>21950</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-03</td>
      <td>0</td>
      <td></td>
      <td>EX</td>
      <td>29.0</td>
      <td>-55.7</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1951</td>
      <td>1</td>
      <td>3</td>
      <td>10</td>
    </tr>
    <tr>
      <th>21951</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-03</td>
      <td>600</td>
      <td></td>
      <td>EX</td>
      <td>27.5</td>
      <td>-54.8</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1951</td>
      <td>1</td>
      <td>3</td>
      <td>10</td>
    </tr>
    <tr>
      <th>21952</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-03</td>
      <td>1200</td>
      <td></td>
      <td>EX</td>
      <td>26.5</td>
      <td>-54.5</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>1951</td>
      <td>1</td>
      <td>3</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>

<p>Uma limpeza final será feita nas entradas de texto:</p>
<div class="codehilite"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Name</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Event</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Status</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">(array([&#39;                AMY&#39;, &#39;                ANA&#39;,</span>
<span class="err">        &#39;                BOB&#39;, &#39;                DOG&#39;,</span>
<span class="err">        &#39;                DON&#39;], dtype=object),</span>
<span class="err"> array([&#39;  &#39;, &#39; C&#39;, &#39; G&#39;, &#39; I&#39;, &#39; L&#39;, &#39; P&#39;, &#39; R&#39;, &#39; S&#39;, &#39; T&#39;, &#39; W&#39;],</span>
<span class="err">       dtype=object),</span>
<span class="err"> array([&#39; DB&#39;, &#39; EX&#39;, &#39; HU&#39;, &#39; LO&#39;, &#39; SD&#39;, &#39; SS&#39;, &#39; TD&#39;, &#39; TS&#39;, &#39; WV&#39;],</span>
<span class="err">       dtype=object))</span>
</code></pre></div>


<p>Veja que as entradas estão espaçadas, abaixo corrigimos isso:</p>
<div class="codehilite"><pre><span></span><code><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Name</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Event</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Status</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">(array([&#39;ABBY&#39;, &#39;ABLE&#39;, &#39;AGNES&#39;, &#39;ALBERTO&#39;, &#39;ALEX&#39;], dtype=object),</span>
<span class="err"> array([&#39;&#39;, &#39;C&#39;, &#39;G&#39;, &#39;I&#39;, &#39;L&#39;, &#39;P&#39;, &#39;R&#39;, &#39;S&#39;, &#39;T&#39;, &#39;W&#39;], dtype=object),</span>
<span class="err"> array([&#39;DB&#39;, &#39;EX&#39;, &#39;HU&#39;, &#39;LO&#39;, &#39;SD&#39;, &#39;SS&#39;, &#39;TD&#39;, &#39;TS&#39;, &#39;WV&#39;], dtype=object))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">#Salvando em csv</span>
<span class="n">data_atl_mw2_filtrado3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_atl_mw2_filtrado3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../Datasets/data_atl_mw2_filtrado3.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<h2 id="uniao-dos-dados-via-k-nn-ponderado">União dos dados via k-NN ponderado</h2>
<p>Abaixo vamos gerar um novo dataframe que pegará o filtrado3.csv gerado acima e buscará os dados climáticos nos datasets da ICOADS diretamente dos arquivos .nc. Faremos essa busca via coordenadas e para lidar com dados faltantes implementaremos um k-NN ponderado pelo inverso das distâncias entre as coordenadas originais e o vizinho considerado no algoritmo.</p>
<h3 id="leitura-dos-dados-e-limpezas-adicionais">Leitura dos dados e limpezas adicionais</h3>
<div class="codehilite"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Datasets/data_atl_mw2_filtrado3.csv&#39;</span><span class="p">,</span><span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">ID</span><span class="w">                          </span><span class="k">object</span><span class="w"></span>
<span class="n">Name</span><span class="w">                        </span><span class="k">object</span><span class="w"></span>
<span class="nc">Date</span><span class="w">                </span><span class="n">datetime64</span><span class="o">[</span><span class="n">ns</span><span class="o">]</span><span class="w"></span>
<span class="nc">Time</span><span class="w">                         </span><span class="n">int64</span><span class="w"></span>
<span class="n">Event</span><span class="w">                       </span><span class="k">object</span><span class="w"></span>
<span class="n">Status</span><span class="w">                      </span><span class="k">object</span><span class="w"></span>
<span class="n">Latitude</span><span class="w">                   </span><span class="n">float64</span><span class="w"></span>
<span class="n">Longitude</span><span class="w">                  </span><span class="n">float64</span><span class="w"></span>
<span class="n">Maximum</span><span class="w"> </span><span class="n">Wind</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">Minimum</span><span class="w"> </span><span class="n">Pressure</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NE</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SE</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SW</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Low</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NW</span><span class="w">                  </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NE</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SE</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SW</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Moderate</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NW</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NE</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SE</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">SW</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">High</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="n">NW</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="nf">Year</span><span class="w">                         </span><span class="n">int64</span><span class="w"></span>
<span class="nf">Month</span><span class="w">                        </span><span class="n">int64</span><span class="w"></span>
<span class="nf">Day</span><span class="w">                          </span><span class="n">int64</span><span class="w"></span>
<span class="n">Duration</span><span class="w">                     </span><span class="n">int64</span><span class="w"></span>
<span class="nl">dtype</span><span class="p">:</span><span class="w"> </span><span class="k">object</span><span class="w"></span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                 <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
             <span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Variable&#39;</span><span class="p">,</span><span class="s1">&#39;Missing Ratio&#39;</span><span class="p">])</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Missing Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ID</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Name</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Date</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Time</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Event</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Status</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Latitude</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Longitude</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Maximum Wind</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Minimum Pressure</td>
      <td>0.256723</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Low Wind NE</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Low Wind SE</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Low Wind SW</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Low Wind NW</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Moderate Wind NE</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Moderate Wind SE</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Moderate Wind SW</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Moderate Wind NW</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>18</th>
      <td>High Wind NE</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>19</th>
      <td>High Wind SE</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>20</th>
      <td>High Wind SW</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>21</th>
      <td>High Wind NW</td>
      <td>0.750201</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Year</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Month</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Day</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Duration</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>

<p>Removeremos as colunas abaixo, pois não utilizaremos nas análises e são muitos esparsas</p>
<div class="codehilite"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Low Wind NE&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Low Wind SE&#39;</span><span class="p">,</span> <span class="s1">&#39;Low Wind SW&#39;</span><span class="p">,</span> <span class="s1">&#39;Low Wind NW&#39;</span><span class="p">,</span> <span class="s1">&#39;Moderate Wind NE&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Moderate Wind SE&#39;</span><span class="p">,</span> <span class="s1">&#39;Moderate Wind SW&#39;</span><span class="p">,</span> <span class="s1">&#39;Moderate Wind NW&#39;</span><span class="p">,</span>
       <span class="s1">&#39;High Wind NE&#39;</span><span class="p">,</span> <span class="s1">&#39;High Wind SE&#39;</span><span class="p">,</span> <span class="s1">&#39;High Wind SW&#39;</span><span class="p">,</span> <span class="s1">&#39;High Wind NW&#39;</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<p>Na célula abaixo, lemos os dados climáticos e os salvamos en variáveis para uso futuro.</p>
<div class="codehilite"><pre><span></span><code><span class="n">sst_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;sst.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">rhum_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;rhum.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">wspd_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;wspd.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">slp_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;slp.mean.nc&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c1"># vwnd_mean = nc.Dataset(&#39;Datasets/vwnd.mean.nc&#39;,&#39;r&#39;)</span>
<span class="c1"># Resolvemos não considerar o vwnd por ser ruído</span>
<span class="n">cldc_mean</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;cldc.mean.nc&quot;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">lats</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][:]</span>

<span class="n">lons</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">180</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lons</span><span class="p">]</span>
<span class="n">lats</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lats</span><span class="p">]</span>

<span class="n">sst</span> <span class="o">=</span> <span class="n">sst_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">][:,:,:]</span>
<span class="n">rhum</span> <span class="o">=</span> <span class="n">rhum_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;rhum&#39;</span><span class="p">][:,:,:]</span>
<span class="n">wspd</span> <span class="o">=</span> <span class="n">wspd_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;wspd&#39;</span><span class="p">][:,:,:]</span>
<span class="n">slp</span> <span class="o">=</span> <span class="n">slp_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;slp&#39;</span><span class="p">][:,:,:]</span>
<span class="n">cldc</span> <span class="o">=</span> <span class="n">cldc_mean</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;cldc&#39;</span><span class="p">][:,:,:]</span>

<span class="n">sst_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">wspd_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">rhum_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">slp_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">cldc_mean</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>


<h3 id="formula-da-distancia">Formula da distância</h3>
<p>Dados duas coordenadas <script type="math/tex">(\varphi_1,\lambda_1)</script> e (<script type="math/tex">\varphi_2,\lambda_2)</script> em radianos, a <a href="https://wikimedia.org/api/rest_v1/media/math/render/svg/a65dbbde43ff45bacd2505fcf32b44fc7dcd8cc0">Fórmula Haversine</a> é capaz de calcular a distância real entre esses dois pontos no mapa:</p>
<p><img alt="teste" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a65dbbde43ff45bacd2505fcf32b44fc7dcd8cc0" /></p>
<p>Onde <script type="math/tex">r</script> é o raio da Terra.</p>
<p>Usando <script type="math/tex">r</script> aproximadamente igual a <script type="math/tex">6371</script> km o valor de <script type="math/tex">d</script> será a distância em km dos dois pontos dados em coordenadas geográficas.</p>
<p>Abaixo, seguimos uma implementação equivalente obtida no <a href="https://stackoverflow.com/questions/19412462/getting-distance-between-two-points-based-on-latitude-longitude">Stack Overflow</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat2</span><span class="p">,</span><span class="n">lon2</span><span class="p">):</span>
    <span class="c1"># approximate radius of earth in km</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">6371.0</span>

    <span class="n">lat1</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
    <span class="n">lon1</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
    <span class="n">lat2</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
    <span class="n">lon2</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>

    <span class="n">dlon</span> <span class="o">=</span> <span class="n">lon2</span> <span class="o">-</span> <span class="n">lon1</span>
    <span class="n">dlat</span> <span class="o">=</span> <span class="n">lat2</span> <span class="o">-</span> <span class="n">lat1</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">dlat</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">dlon</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">R</span><span class="o">*</span><span class="n">c</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.000000001</span> <span class="c1">#Handling Zero Division problems</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">R</span> <span class="o">*</span> <span class="n">c</span>
</code></pre></div>


<h3 id="k-nn-ponderado-por-inverso-da-distancia">k-NN ponderado por inverso da distância</h3>
<p>Abaixo segue a implementação de algumas funções auxiliares para realizar esse preenchimento de dados almejado. o que queremos é dos dados que filtramos do HURDAT, para cada linha, usando as coordenadas geográficas, gerar novas colunas contendo os dados do ICOADS para aquela data espefícica e aquela coordenada específica.</p>
<p>Por conta de dados faltantes no ICOADS, nem sempre existirá registros para todas as coordenadas. Assim, buscamos os <script type="math/tex">k</script> vizinhos mais próximos a calculamos a média entre eles, porém a média é ponderada pelo inverso da distância entre o vizinho e a coordenada original (usando a Fórmula Haversive). Sendo assim, pontos mais distantes terão menor peso na média, enquanto pontos mais próximos serão considerados mais importantes.</p>
<p>Por simplicidade, usamos <script type="math/tex">k=15</script>.</p>
<p>Funcionamento das funções:</p>
<ul>
<li>get_coords: recebe uma coordenada e a lista de coordenadas disponíveis no ICOADS. Retorna uma coordenada que existe na lista passada. Precisamos dessa função pois os dados de coordenadas do ICOADS são intervalados 2 a 2.</li>
<li>get_neighboors: recebe uma data, latitude, longitude, uma array de dados do ICOADS e a quantidade de vizinhos a buscar. Retorna uma lista de <script type="math/tex">k</script> vizinhos e uma lista de distâncias em kilometros.</li>
<li>get_data: usa as funções acima para gerar a média ponderada pelo inverso da distância</li>
<li>get_data_df: aplica as funções acima para gerar uma nova coluna nos dados HURDAT2 da forma como almejado inicialmente.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_coord</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>
    <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">get_neighboors</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">marray</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">lat_data</span> <span class="o">=</span> <span class="n">get_coord</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lats</span><span class="p">)</span> <span class="c1">#nearest lat in our lats list</span>
    <span class="n">lon_data</span> <span class="o">=</span> <span class="n">get_coord</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lons</span><span class="p">)</span>
    <span class="n">lat_i</span> <span class="o">=</span> <span class="n">lats</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">lat_data</span><span class="p">)</span>
    <span class="n">lon_i</span> <span class="o">=</span> <span class="n">lons</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">lon_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">marray</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">lat_i</span><span class="p">,</span><span class="n">lon_i</span><span class="p">]:</span>
        <span class="n">nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marray</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">lat_i</span><span class="p">,</span><span class="n">lon_i</span><span class="p">])</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lat_data</span><span class="p">,</span><span class="n">lon_data</span><span class="p">))</span>
    <span class="n">j</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span><span class="o">&lt;</span><span class="n">k</span><span class="p">:</span>

        <span class="n">lower_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat_i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="c1">#%90</span>
        <span class="n">upper_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat_i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="c1">#%90</span>
        <span class="n">right_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon_i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="c1">#%180</span>
        <span class="n">left_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon_i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="c1">#%180</span>
<span class="c1">#         if right_i&gt;=len()</span>
        <span class="n">left_values</span> <span class="o">=</span> <span class="n">marray</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">lower_i</span><span class="p">:</span><span class="n">upper_i</span><span class="p">,</span><span class="n">left_i</span><span class="p">]</span>
        <span class="n">upper_values</span> <span class="o">=</span> <span class="n">marray</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">upper_i</span><span class="p">,</span><span class="n">left_i</span><span class="p">:</span><span class="n">right_i</span><span class="p">]</span>
        <span class="n">right_values</span> <span class="o">=</span> <span class="n">marray</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">upper_i</span><span class="p">:</span><span class="n">lower_i</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">right_i</span><span class="p">]</span>
        <span class="n">lower_values</span> <span class="o">=</span> <span class="n">marray</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">lower_i</span><span class="p">,</span><span class="n">right_i</span><span class="p">:</span><span class="n">left_i</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="p">[</span><span class="n">nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">left_values</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
        <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lats</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lons</span><span class="p">[</span><span class="n">left_i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">left_values</span><span class="p">))</span> <span class="k">if</span> <span class="n">left_values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">k</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="p">[</span><span class="n">nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">upper_values</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
        <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lats</span><span class="p">[</span><span class="n">upper_i</span><span class="p">],</span><span class="n">lons</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">upper_values</span><span class="p">))</span> <span class="k">if</span> <span class="n">upper_values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">k</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="p">[</span><span class="n">nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">right_values</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
        <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lats</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lons</span><span class="p">[</span><span class="n">right_i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">right_values</span><span class="p">))</span> <span class="k">if</span> <span class="n">right_values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">k</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="p">[</span><span class="n">nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lower_values</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
        <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lats</span><span class="p">[</span><span class="n">lower_i</span><span class="p">],</span><span class="n">lons</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lower_values</span><span class="p">))</span> <span class="k">if</span> <span class="n">lower_values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">k</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">prob</span><span class="o">!=</span><span class="p">[]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nb</span><span class="p">,</span><span class="n">dist</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1800-01-01&quot;</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2020-07-01&quot;</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">datetime</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">dataset</span><span class="p">,</span><span class="n">k</span><span class="p">):</span><span class="c1">#k is the number of neighboors</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">year</span>
    <span class="n">month</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">month</span>
    <span class="n">time_index</span> <span class="o">=</span> <span class="n">period</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">nb</span><span class="p">,</span><span class="n">dist</span> <span class="o">=</span> <span class="n">get_neighboors</span><span class="p">(</span><span class="n">time_index</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">dataset</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    <span class="n">inv_dist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dist</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">inv_dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nb</span><span class="p">)))</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">inv_dist</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_data_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">dataset</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="mi">1</span><span class="p">]),</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
        <span class="n">output</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Date</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">df</span><span class="o">.</span><span class="n">Latitude</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">df</span><span class="o">.</span><span class="n">Longitude</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">dataset</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div>


<p>Abaixo executamos tudo que foi implementado acima para gerar o novo dataframe. Salvamos em um novo csv que usaremos nas próximas análises.</p>
<div class="codehilite"><pre><span></span><code><span class="o">%%</span><span class="n">time</span>
<span class="c1"># Esta célula demora um pouco a ser executada; Todos essas dados já estão salvos em data_atl_merged2.csv</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;sst&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">get_data_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">sst</span><span class="p">,</span><span class="s1">&#39;sst&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK -- sst&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;rhum&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">get_data_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">rhum</span><span class="p">,</span><span class="s1">&#39;rhum&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK -- rhum&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;wspd&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">get_data_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">rhum</span><span class="p">,</span><span class="s1">&#39;wspd&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK -- wspd&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;slp&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">get_data_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">slp</span><span class="p">,</span><span class="s1">&#39;slp&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK -- slp&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cldc&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">get_data_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">cldc</span><span class="p">,</span><span class="s1">&#39;cldc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK -- cldc</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">OK</span> <span class="c1">-- sst</span>
<span class="n">OK</span> <span class="c1">-- rhum</span>
<span class="n">OK</span> <span class="c1">-- wspd</span>
<span class="n">OK</span> <span class="c1">-- slp</span>
<span class="n">OK</span> <span class="c1">-- cldc</span>

<span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="k">user</span> <span class="mi">2</span><span class="k">min</span> <span class="mi">34</span><span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">868</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mi">2</span><span class="k">min</span> <span class="mi">35</span><span class="n">s</span>
<span class="n">Wall</span> <span class="k">time</span><span class="p">:</span> <span class="mi">2</span><span class="k">min</span> <span class="mi">33</span><span class="n">s</span>





<span class="k">Index</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">,</span> <span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;rhum&#39;</span><span class="p">,</span>
       <span class="s1">&#39;wspd&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">,</span> <span class="s1">&#39;cldc&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../Datasets/data_atl_merged2.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Datasets/data_atl_merged2.csv&#39;</span><span class="p">,</span><span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">ID</span><span class="w">                          </span><span class="k">object</span><span class="w"></span>
<span class="n">Name</span><span class="w">                        </span><span class="k">object</span><span class="w"></span>
<span class="nc">Date</span><span class="w">                </span><span class="n">datetime64</span><span class="o">[</span><span class="n">ns</span><span class="o">]</span><span class="w"></span>
<span class="nc">Time</span><span class="w">                         </span><span class="n">int64</span><span class="w"></span>
<span class="n">Event</span><span class="w">                       </span><span class="k">object</span><span class="w"></span>
<span class="n">Status</span><span class="w">                      </span><span class="k">object</span><span class="w"></span>
<span class="n">Latitude</span><span class="w">                   </span><span class="n">float64</span><span class="w"></span>
<span class="n">Longitude</span><span class="w">                  </span><span class="n">float64</span><span class="w"></span>
<span class="n">Maximum</span><span class="w"> </span><span class="n">Wind</span><span class="w">                 </span><span class="n">int64</span><span class="w"></span>
<span class="n">Minimum</span><span class="w"> </span><span class="n">Pressure</span><span class="w">             </span><span class="n">int64</span><span class="w"></span>
<span class="n">Date_c</span><span class="w">                      </span><span class="k">object</span><span class="w"></span>
<span class="nf">Year</span><span class="w">                         </span><span class="n">int64</span><span class="w"></span>
<span class="nf">Month</span><span class="w">                        </span><span class="n">int64</span><span class="w"></span>
<span class="nf">Day</span><span class="w">                          </span><span class="n">int64</span><span class="w"></span>
<span class="n">Latitude_c</span><span class="w">                 </span><span class="n">float64</span><span class="w"></span>
<span class="n">Longitude_c</span><span class="w">                </span><span class="n">float64</span><span class="w"></span>
<span class="n">Duration</span><span class="w">                     </span><span class="n">int64</span><span class="w"></span>
<span class="n">sst</span><span class="w">                        </span><span class="n">float64</span><span class="w"></span>
<span class="n">rhum</span><span class="w">                       </span><span class="n">float64</span><span class="w"></span>
<span class="n">wspd</span><span class="w">                       </span><span class="n">float64</span><span class="w"></span>
<span class="n">slp</span><span class="w">                        </span><span class="n">float64</span><span class="w"></span>
<span class="n">cldc</span><span class="w">                       </span><span class="n">float64</span><span class="w"></span>
<span class="nl">dtype</span><span class="p">:</span><span class="w"> </span><span class="k">object</span><span class="w"></span>
</code></pre></div>


<h2 id="outras-visualizacoes">Outras Visualizações</h2>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">dfplot</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]]</span>
<span class="k">def</span> <span class="nf">category</span><span class="p">(</span><span class="n">mw</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mw</span><span class="o">&gt;=</span><span class="mi">137</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Categoria 5&quot;</span>
    <span class="k">elif</span> <span class="n">mw</span><span class="o">&gt;=</span><span class="mi">113</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Categoria 4&quot;</span>
    <span class="k">elif</span> <span class="n">mw</span><span class="o">&gt;=</span><span class="mi">96</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Categoria 3&quot;</span>
    <span class="k">elif</span> <span class="n">mw</span><span class="o">&gt;=</span><span class="mi">83</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Categoria 2&quot;</span>
    <span class="k">elif</span> <span class="n">mw</span><span class="o">&gt;=</span><span class="mi">64</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Categoria 1&quot;</span>
    <span class="k">elif</span> <span class="n">mw</span><span class="o">&gt;=</span><span class="mi">34</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Tropical Storm&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Tropical Depression&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Nº Tempestades por Categoria Máxima&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">cat_id</span> <span class="o">=</span> <span class="n">dfplot</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">)[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>
<span class="n">dfplot</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Categoria&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfplot</span><span class="o">.</span><span class="n">ID</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">cat_id</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="n">dfplot</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Categoria&#39;</span><span class="p">)[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">();</span>
<span class="c1"># plt.savefig(&#39;figs/hur_by_category.jpg&#39;)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_68_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="c1">#Major Hurricanes by Year</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Nº Furacões Graves por ano (Cat&gt;=3)&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">major_df</span> <span class="o">=</span> <span class="n">dfplot</span><span class="p">[</span><span class="n">dfplot</span><span class="o">.</span><span class="n">Categoria</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;m&#39;</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">]</span>
<span class="n">major_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Ano&quot;</span><span class="p">);</span>
<span class="c1"># plt.savefig(&quot;figs/major_hurricanes_year.jpg&quot;)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_69_0.png" /></p>
<p>Nos plots abaixo usaremos a biblioteca troPYcal. Internamente ela tem o dataset HURDAT2 atualizado e possui funções de visualização prontas, simples de serem usadas.</p>
<p>Referência: https://tropycal.github.io/tropycal/examples/index.html</p>
<div class="codehilite"><pre><span></span><code><span class="n">hurdat_atl</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">.</span><span class="n">TrackDataset</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;north_atlantic&#39;</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;hurdat&#39;</span><span class="p">,</span><span class="n">include_btk</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">storm</span> <span class="o">=</span> <span class="n">hurdat_atl</span><span class="o">.</span><span class="n">get_storm</span><span class="p">((</span><span class="s1">&#39;michael&#39;</span><span class="p">,</span><span class="mi">2018</span><span class="p">))</span>

<span class="c1">#</span>
<span class="n">storm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">return_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPycal_michal18.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">--&gt; Starting to read in HURDAT2 data</span>
<span class="err">--&gt; Completed reading in HURDAT2 data (4.0 seconds)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_71_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">storm</span><span class="o">.</span><span class="n">plot_tors</span><span class="p">(</span><span class="n">plotPPH</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_michaelPPH.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">--&gt; Starting to read in tornado track data</span>
<span class="err">--&gt; Completed reading in tornado data for 1950-2018 (10.42 seconds)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_72_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="err">&lt;Figure size 432x288 with 0 Axes&gt;</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">storm</span><span class="o">.</span><span class="n">plot_nhc_forecast</span><span class="p">(</span><span class="n">forecast</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">return_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_michael_fore2.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_73_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">storm</span><span class="o">.</span><span class="n">plot_nhc_forecast</span><span class="p">(</span><span class="n">forecast</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">return_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_michael_fore12.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_74_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">ibtracs</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">.</span><span class="n">TrackDataset</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;ibtracs&#39;</span><span class="p">,</span><span class="n">ibtracs_mode</span><span class="o">=</span><span class="s1">&#39;jtwc_neumann&#39;</span><span class="p">,</span><span class="n">catarina</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">storm</span> <span class="o">=</span> <span class="n">ibtracs</span><span class="o">.</span><span class="n">get_storm</span><span class="p">((</span><span class="s1">&#39;catarina&#39;</span><span class="p">,</span><span class="mi">2004</span><span class="p">))</span>
<span class="n">storm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">return_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_catarina.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">--&gt; Starting to read in ibtracs data</span>
<span class="err">--&gt; Completed reading in ibtracs data (114.01 seconds)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_75_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">tor_data</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">TornadoDataset</span><span class="p">()</span>

<span class="n">tor_ax</span><span class="p">,</span><span class="n">domain</span><span class="p">,</span><span class="n">leg_tor</span> <span class="o">=</span> <span class="n">tor_data</span><span class="o">.</span><span class="n">plot_tors</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">27</span><span class="p">),</span><span class="n">plotPPH</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">return_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tor_ax</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_dailyPPH.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">--&gt; Starting to read in tornado track data</span>
<span class="err">--&gt; Completed reading in tornado data for 1950-2018 (9.15 seconds)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_76_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">hurdat_atl</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">.</span><span class="n">TrackDataset</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;north_atlantic&#39;</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;hurdat&#39;</span><span class="p">,</span><span class="n">include_btk</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># #</span>
<span class="n">hurdat_atl</span><span class="o">.</span><span class="n">assign_storm_tornadoes</span><span class="p">(</span><span class="n">dist_thresh</span><span class="o">=</span><span class="mi">750</span><span class="p">)</span>
<span class="c1"># #</span>
<span class="n">storm</span> <span class="o">=</span> <span class="n">hurdat_atl</span><span class="o">.</span><span class="n">get_storm</span><span class="p">((</span><span class="s1">&#39;ivan&#39;</span><span class="p">,</span><span class="mi">2004</span><span class="p">))</span>
<span class="c1"># #</span>
<span class="n">storm</span><span class="o">.</span><span class="n">plot_tors</span><span class="p">(</span><span class="n">plotPPH</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">return_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_ivan04.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">--&gt; Starting to read in HURDAT2 data</span>
<span class="err">--&gt; Completed reading in HURDAT2 data (8.13 seconds)</span>
<span class="err">--&gt; Starting to read in tornado track data</span>
<span class="err">--&gt; Completed reading in tornado data for 1950-2018 (9.86 seconds)</span>
<span class="err">--&gt; Starting to assign tornadoes to storms</span>
<span class="err">--&gt; Completed assigning tornadoes to storm (403.30 seconds)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_77_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">hurdat_atl</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">.</span><span class="n">TrackDataset</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;north_atlantic&#39;</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;hurdat&#39;</span><span class="p">,</span><span class="n">include_btk</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#Retrieve Hurricane Michael from 2018</span>
<span class="n">storm</span> <span class="o">=</span> <span class="n">hurdat_atl</span><span class="o">.</span><span class="n">get_storm</span><span class="p">((</span><span class="s1">&#39;michael&#39;</span><span class="p">,</span><span class="mi">2018</span><span class="p">))</span>

<span class="c1">#Retrieve the 2017 Atlantic hurricane season</span>
<span class="n">season</span> <span class="o">=</span> <span class="n">hurdat_atl</span><span class="o">.</span><span class="n">get_season</span><span class="p">(</span><span class="mi">2017</span><span class="p">)</span>

<span class="c1">#Printing the Storm object lists relevant data:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">storm</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">hurdat_atl</span><span class="o">.</span><span class="n">search_name</span><span class="p">(</span><span class="s1">&#39;Michael&#39;</span><span class="p">))</span>
<span class="c1">#</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">--&gt; Starting to read in HURDAT2 data</span>
<span class="c1">--&gt; Completed reading in HURDAT2 data (4.39 seconds)</span>
<span class="o">&lt;</span><span class="n">tropycal</span><span class="p">.</span><span class="n">tracks</span><span class="p">.</span><span class="n">Storm</span><span class="o">&gt;</span>
<span class="n">Storm</span> <span class="n">Summary</span><span class="p">:</span>
    <span class="n">Maximum</span> <span class="n">Wind</span><span class="p">:</span>      <span class="mi">140</span> <span class="n">knots</span>
    <span class="n">Minimum</span> <span class="n">Pressure</span><span class="p">:</span>  <span class="mi">919</span> <span class="n">hPa</span>
    <span class="k">Start</span> <span class="nb">Date</span><span class="p">:</span>        <span class="mi">0600</span> <span class="n">UTC</span> <span class="mi">07</span> <span class="n">October</span> <span class="mi">2018</span>
    <span class="k">End</span> <span class="nb">Date</span><span class="p">:</span>          <span class="mi">1800</span> <span class="n">UTC</span> <span class="mi">11</span> <span class="n">October</span> <span class="mi">2018</span>

<span class="n">Variables</span><span class="p">:</span>
    <span class="nb">date</span>        <span class="p">(</span><span class="n">datetime</span><span class="p">)</span> <span class="p">[</span><span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">06</span> <span class="mi">18</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="p">....</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">15</span> <span class="mi">18</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span>
    <span class="n">extra_obs</span>   <span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span> <span class="p">....</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">special</span>     <span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">[</span> <span class="p">....</span> <span class="p">]</span>
    <span class="k">type</span>        <span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">[</span><span class="n">LO</span> <span class="p">....</span> <span class="n">EX</span><span class="p">]</span>
    <span class="n">lat</span>         <span class="p">(</span><span class="n">float64</span><span class="p">)</span> <span class="p">[</span><span class="mi">17</span><span class="p">.</span><span class="mi">8</span> <span class="p">....</span> <span class="mi">41</span><span class="p">.</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">lon</span>         <span class="p">(</span><span class="n">float64</span><span class="p">)</span> <span class="p">[</span><span class="o">-</span><span class="mi">86</span><span class="p">.</span><span class="mi">6</span> <span class="p">....</span> <span class="o">-</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">vmax</span>        <span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="p">[</span><span class="mi">25</span> <span class="p">....</span> <span class="mi">35</span><span class="p">]</span>
    <span class="n">mslp</span>        <span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="p">[</span><span class="mi">1006</span> <span class="p">....</span> <span class="mi">1001</span><span class="p">]</span>
    <span class="n">wmo_basin</span>   <span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">[</span><span class="n">north_atlantic</span> <span class="p">....</span> <span class="n">north_atlantic</span><span class="p">]</span>

<span class="k">More</span> <span class="n">Information</span><span class="p">:</span>
    <span class="n">id</span><span class="p">:</span>              <span class="n">AL142018</span>
    <span class="n">operational_id</span><span class="p">:</span>  <span class="n">AL142018</span>
    <span class="n">name</span><span class="p">:</span>            <span class="n">MICHAEL</span>
    <span class="k">year</span><span class="p">:</span>            <span class="mi">2018</span>
    <span class="n">season</span><span class="p">:</span>          <span class="mi">2018</span>
    <span class="n">basin</span><span class="p">:</span>           <span class="n">north_atlantic</span>
    <span class="n">source_info</span><span class="p">:</span>     <span class="n">NHC</span> <span class="n">Hurricane</span> <span class="k">Database</span>
    <span class="k">source</span><span class="p">:</span>          <span class="n">hurdat</span>
    <span class="n">ace</span><span class="p">:</span>             <span class="mi">12</span><span class="p">.</span><span class="mi">5</span>
    <span class="n">realtime</span><span class="p">:</span>        <span class="k">False</span>
<span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2018</span><span class="p">]</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">hurdat_atl</span><span class="o">.</span><span class="n">ace_climo</span><span class="p">(</span><span class="n">plot_year</span><span class="o">=</span><span class="mi">2018</span><span class="p">,</span><span class="n">compare_years</span><span class="o">=</span><span class="mi">2017</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_ACE.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_79_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="err">&lt;Figure size 432x288 with 0 Axes&gt;</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">hurdat_atl</span><span class="o">.</span><span class="n">ace_climo</span><span class="p">(</span><span class="n">rolling_sum</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">plot_year</span><span class="o">=</span><span class="mi">2018</span><span class="p">,</span><span class="n">compare_years</span><span class="o">=</span><span class="mi">2017</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_ACE_rolling.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_80_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="err">&lt;Figure size 432x288 with 0 Axes&gt;</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">hurdat_atl</span><span class="o">.</span><span class="n">wind_pres_relationship</span><span class="p">(</span><span class="n">storm</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;sandy&#39;</span><span class="p">,</span><span class="mi">2012</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_wind_press.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_81_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="err">&lt;Figure size 432x288 with 0 Axes&gt;</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># ibtracs = tracks.TrackDataset(basin=&#39;all&#39;,source=&#39;ibtracs&#39;,ibtracs_mode=&#39;jtwc_neumann&#39;,catarina=True)</span>

<span class="n">ibtracs</span><span class="o">.</span><span class="n">gridded_stats</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="s2">&quot;maximum wind&quot;</span><span class="p">,</span><span class="n">return_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_maxwind.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">--&gt; Getting filtered storm tracks</span>
<span class="err">--&gt; Grouping by lat/lon/storm</span>
<span class="err">--&gt; Generating plot</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_82_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">ibtracs</span><span class="o">.</span><span class="n">gridded_stats</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="s2">&quot;number of storms&quot;</span><span class="p">,</span><span class="n">thresh</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dv_min&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">},</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="s1">&#39;plasma_r&#39;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../figs/troPYcal_num_storms.jpg&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">--&gt; Getting filtered storm tracks</span>
<span class="err">--&gt; Grouping by lat/lon/storm</span>
<span class="err">--&gt; Generating plot</span>
</code></pre></div>


<p><img alt="png" src="../Data_Cleaning_and_EDA_files/Data_Cleaning_and_EDA_83_1.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Analises_variaveis/" class="btn btn-neutral float-right" title="Destrutividade no curto prazo">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Analises_variaveis/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
