<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Destrutividade no curto prazo - Hurricanes in Atlantic</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Destrutividade no curto prazo";
    var mkdocs_page_input_path = "Analises_variaveis.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Hurricanes in Atlantic</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning_and_EDA/">Data Cleaning + EDA</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Destrutividade no curto prazo</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#analises-iniciais">Análises Iniciais</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#modelos-com-separacao-em-conjuntos-de-treino-e-teste">Modelos com Separação em Conjuntos de Treino e Teste</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#regressao-linear">Regressão Linear</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#random-forest">Random Forest</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#demais-previsoes-com-random-forest-melhor-ajuste">Demais Previsões com Random Forest (Melhor Ajuste)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#previsao-da-duracao-dos-eventos-de-furacao">Previsão da duração dos eventos de Furacão</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../PowerDissipationIndex/">Destrutividade no longo prazo</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../NN-TrackPrediction/">Prevendo trajetórias</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Hurricanes in Atlantic</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Destrutividade no curto prazo</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="aplicacao-de-modelos-de-regressao">Aplicação de Modelos de Regressão</h1>
<p><a href="https://github.com/reneroliveira/Hurricane_Project/blob/master/Notebooks/Analises_variaveis.ipynb">Notebook referência</a></p>
<p>Nesta página iremos mostrar os diversos algoritmos aplicados aos dados visando ajustar uma boa regressão que ajudasse a prever as velocidades dos ventos de um determinado evento (Tropical Storm ou Hurricane) ou a duração dos mesmos.
Algumas pequenas transformações foram necessárias para ajuste das variáveis preditoras a serem consideradas em cada modelo. Para detalhes sobre o carregamento e preparação dos dados, veja o notebook referência.</p>
<h2 id="analises-iniciais">Análises Iniciais</h2>
<p>Segue abaixo o resultado da aplicação de uma regressão linear simples usando como variável alvo a velocidade de vento, dado usado em vários indicadores de destrutibilidade. Interessante notar os parâmetros com coeficientes positivos.</p>
<details>
<summary>Código</summary>

<div class="codehilite"><pre><span></span><code><span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train_mw</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_const  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Year  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Month  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Latitude  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Longitude  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_sst  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_rhum  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_wspd  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_slp  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_cldc  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>


</details>

<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.02385621171100183</span>
<span class="err">Parâmetro_const  = 47.35464784180999</span>
<span class="err">Parâmetro_Year  = 0.09050506606867095</span>
<span class="err">Parâmetro_Month  = -0.05872870746380546</span>
<span class="err">Parâmetro_Latitude  = -0.08576970286238517</span>
<span class="err">Parâmetro_Longitude  = 1.880119707824508</span>
<span class="err">Parâmetro_sst  = 0.15179194438994867</span>
<span class="err">Parâmetro_rhum  = 0.028283243122749335</span>
<span class="err">Parâmetro_wspd  = 0.028283243122749446</span>
<span class="err">Parâmetro_slp  = 0.14971356534654948</span>
<span class="err">Parâmetro_cldc  = -1.5161434590996923</span>
</code></pre></div>


<p>Os códigos abaixos nos geram visualizações que podem trazer insights a respeito da relação entre as variáveis. A escolha das variáveis preditoras que servem de entrada para os modelos mais a frente foram pensadas também pela observação destes gráficos.</p>
<details>
<summary>Código</summary>

<div class="codehilite"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">y_train_mp</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">scatter_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">diagonal</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">);</span>
</code></pre></div>


</details>

<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_13_0.png" /></p>
<details>
<summary>Código</summary>

<div class="codehilite"><pre><span></span><code><span class="c1"># A princípio, não queremos que se faça alguma previsão com base no valor numérico do ano</span>
<span class="c1"># Além disso, a variável wspd está altamente correlacionada com a rhum, podendo ser mantida apenas a última</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#   Mês      Latitude    Longitude    Temperatura, Umidade, Sea Level Pressure, Cloudiness]</span>
<span class="c1"># [&#39;Month&#39;, &#39;Latitude&#39;, &#39;Longitude&#39;, &#39;sst&#39;,       &#39;rhum&#39;,  &#39;slp&#39;,              &#39;cldc&#39;]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Velocidade Máxima vs Variáveis Preditoras (1950-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.06</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;rhum&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;slp&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;cldc&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> 

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


</details>

<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_15_0.png" /></p>
<p>Uma primeira tentativa de ajuste foi feito através da centralização das variáveis preditoras em relação à média, adicionando também termos polinomiais de segunda ordem. No entanto, os resultados do ajuste não mostraram ganhos significativos para o modelo de Regressão Linear Múltipla, e até prejudicaram modelos mais complexos, como Random Forest, Multi Layer Perceptron, entre outros utilizados mais a frente. Detalhes desta parte do código acesse o notebook referência, no link do início desta página.</p>
<h2 id="modelos-com-separacao-em-conjuntos-de-treino-e-teste">Modelos com Separação em Conjuntos de Treino e Teste</h2>
<p>Separamos os dados em conjuntos de treino e de teste. Deste modo, podemos ajustar o algoritmo utilizando os dados de treino, e tentar utilizar esses dados de teste para previsão de outros dados, inclusive futuros.</p>
<h3 id="regressao-linear">Regressão Linear</h3>
<details>
<summary>Código</summary>

<div class="codehilite"><pre><span></span><code><span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">X_test2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train_mw</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>
<span class="n">r2_test</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test2</span><span class="p">)</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test2</span><span class="p">)</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">((</span><span class="n">y_test_mw</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y_test_mw</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_test  = </span><span class="si">{</span><span class="n">r2_test</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">print(f&#39;Parâmetro_const  = {OLSModel.params[0]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Month  = {OLSModel.params[1]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Latitude  = {OLSModel.params[2]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Longitude  = {OLSModel.params[3]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_sst  = {OLSModel.params[4]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_rhum  = {OLSModel.params[5]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_slp  = {OLSModel.params[6]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_cldc  = {OLSModel.params[7]}&#39;)</span>

<span class="sd">print(f&#39;Parâmetro_Month^2  = {OLSModel.params[8]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Latitude^2  = {OLSModel.params[9]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Longitude^2  = {OLSModel.params[10]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_sst^2  = {OLSModel.params[11]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_rhum^2  = {OLSModel.params[12]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_slp^2  = {OLSModel.params[13]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_cldc^2  = {OLSModel.params[14]}&#39;)</span>
<span class="sd">&#39;&#39;&#39;</span>
</code></pre></div>


</details>

<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.019806236602926464</span>
<span class="err">R^2_test  = 0.01874952522766249</span>
</code></pre></div>


<p>Veja abaixo as previsões:</p>
<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_34_0.png" /></p>
<h3 id="random-forest">Random Forest</h3>
<p>Pelos ajustes feitos no notebook com os dados completos usando Random Forest, vimos que esse algoritmo promove um bom ajuste nos dados. Um novo ajuste com aplicação de parâmetros melhor sintonizados com os dados é buscado pelo código abaixo.</p>
<details>
<summary>Código - Random Forest</summary>

<div class="codehilite"><pre><span></span><code><span class="c1"># Parâmetros com bom ajuste para Random Forest: n_estimators = 50, max_depth = 75</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">]:</span>
        <span class="n">regr_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">regr_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
</code></pre></div>


</details>

<p>O R2 Score obtido mostra o melhor ajuste do modelo quando tentamos prever a Velocidade Máxima Sustentada pelo algoritmo do Random Forest. O ajuste aos dados de treino (0.93) fica bem superior aos de teste (0.52). Isso se deve em parte porque os dados se dão em grupos de registros, associados aos eventos de furacões. Assim, um algoritmo acaba por detectar a correlação dos dados dentro de um mesmo evento e busca ajustá-los de modo específico no conjunto de treinamento. No conjunto de teste, quando algum dado se encontra "distante" dos registros que foram utilizados, ele acaba não tendo o mesmo ajuste.</p>
<p>Retirando os dados climáticos, observamos que o ajuste fica bem pior, (Treino - 0.86 e Teste - 0.06) mostrando a importância dos mesmos para a predição. Fizemos mais alguns fits, que podem ser consultados no notebook referência.</p>
<p><strong>Ajuste da predição em relação à variável sst (temperatura mensal média)</strong></p>
<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_48_0.png" /></p>
<h3 id="demais-previsoes-com-random-forest-melhor-ajuste">Demais Previsões com Random Forest (Melhor Ajuste)</h3>
<p>Adicionando as variáveis Ano e Dia, conseguimos melhorar significativamente a capacidade de previsão do nosso modelo (Treino - 0.95 e Teste - 0.66).
Se adicionarmos primeiramente apenas a variável Ano, percebemos que cada variável contribui um pouco para a melhoria da previsão.</p>
<p>Fizemos também um ajuste fino dos parâmetros do Random Forest, de forma a encontrar os valores ótimos para os mesmos. </p>
<p>O melhor ajuste para previsão de Maximal Wind ocorreu com número de árvores (num_estimators) igual a 50 e uma profundidade máxima (max_depth) também igual a 50.</p>
<p>Veja abaixo código, os resultados de R2 e visualizações:</p>
<details>
<summary>Código</summary>

<div class="codehilite"><pre><span></span><code><span class="n">regr_rf2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test</span><span class="p">,</span> <span class="n">data_test_mw</span><span class="p">))</span>
</code></pre></div>


</details>

<div class="codehilite"><pre><span></span><code><span class="err">0.9629951225598822</span>
<span class="err">0.7593567448937373</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_58_0.png" /></p>
<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_59_0.png" /></p>
<h3 id="previsao-da-duracao-dos-eventos-de-furacao">Previsão da duração dos eventos de Furacão</h3>
<p>Fizemos também a previsão da duração de um Furacão. O ajuste fica bem preciso, como se pode ver pelo R2 Score</p>
<details>
<summary>Código </summary>

<div class="codehilite"><pre><span></span><code><span class="n">regr_rf3</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train2</span><span class="p">,</span> <span class="n">data_train_dur</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf3</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_train2</span><span class="p">,</span> <span class="n">data_train_dur</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf3</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test2</span><span class="p">,</span> <span class="n">data_test_dur</span><span class="p">))</span>
</code></pre></div>


</details>

<div class="codehilite"><pre><span></span><code><span class="err">0.9883397102866289</span>
<span class="err">0.9289716458290775</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_64_0.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../PowerDissipationIndex/" class="btn btn-neutral float-right" title="Destrutividade no longo prazo">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Data_Cleaning_and_EDA/" class="btn btn-neutral" title="Data Cleaning + EDA"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Data_Cleaning_and_EDA/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../PowerDissipationIndex/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
