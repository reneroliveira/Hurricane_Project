<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Destrutividade no curto prazo - Hurricanes in Atlantic</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Destrutividade no curto prazo";
    var mkdocs_page_input_path = "Analises_variaveis.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Hurricanes in Atlantic</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning_and_EDA/">Data Cleaning + EDA</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Destrutividade no curto prazo</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#instalacao-e-importacao-de-pacotes">Instalação e Importação de Pacotes</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../PowerDissipationIndex/">Destrutividade no longo prazo</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../NN-TrackPrediction/">Prevendo trajetórias</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Hurricanes in Atlantic</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Destrutividade no curto prazo</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="aplicacao-de-modelos-de-regressao">Aplicação de Modelos de Regressão</h1>
<p>Neste Notebook, iremos importar os dados já limpados/filtrados em etapas anteriores e iremos aplicar diversos algoritmos visando ajustar uma boa regressão que nos ajude a prever as velocidades dos ventos de um determinado evento (Tropical Storm ou Hurricane) ou a duração dos mesmos.
Algumas pequenas transformações serão necessárias para ajuste das variáveis preditoras a serem consideradas em cada modelo.</p>
<h2 id="instalacao-e-importacao-de-pacotes">Instalação e Importação de Pacotes</h2>
<p>Os códigos de instalação abaixo estão comentados. Na primeira utilização do Notebook, pode-se descomentá-los para instalar os pacotes que ainda não estejam instalados no computador que se esteja utilizando.
Além disso, alguns pacotes abaixo são para utilização nos demais notebooks do projeto.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># !apt-get install libgeos-3.5.0</span>
<span class="c1"># !apt-get install libgeos-dev</span>
<span class="c1"># !pip install https://github.com/matplotlib/basemap/archive/master.zip</span>
<span class="c1"># !pip install pyproj==1.9.6</span>
<span class="c1"># !pip install netcdf4</span>

<span class="c1"># Dependencies for Tropycal Package: https://pypi.org/project/tropycal/</span>
<span class="c1"># matplotlib &gt;= 2.2.2</span>
<span class="c1"># numpy &gt;= 1.14.3</span>
<span class="c1"># scipy &gt;= 1.1.0</span>
<span class="c1"># pandas &gt;= 0.23.0</span>
<span class="c1"># geopy &gt;= 1.18.1</span>
<span class="c1"># xarray &gt;= 0.10.7</span>
<span class="c1"># networkx &gt;= 2.0.0</span>
<span class="c1"># requests &gt;= 2.22.0</span>
<span class="c1"># To fully leverage tropycal&#39;s plotting capabilities, it is strongly recommended to have cartopy &gt;= 0.17.0 installed.</span>

<span class="c1"># !pip install numpy</span>
<span class="c1"># !pip install pandas</span>
<span class="c1"># !pip install matplotlib</span>
<span class="c1"># !pip install scipy</span>
<span class="c1"># !pip install geopy</span>
<span class="c1"># !pip install xarray</span>
<span class="c1"># !pip install networkx</span>
<span class="c1"># !pip install requests</span>
<span class="c1"># !pip install proj</span>
<span class="c1"># !pip install proj-data</span>
<span class="c1"># !pip install geos</span>
<span class="c1"># #!pip uninstall cartopy</span>
<span class="c1"># !apt-get -qq install python-cartopy python3-cartopy</span>
<span class="c1"># !pip install cartopy</span>
<span class="c1"># !pip install tropycal</span>
<span class="c1"># #!pip freeze</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">c</span>
<span class="c1">#from mpl_toolkits.basemap import Basemap,shiftgrid</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">date2index</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">geopy</span>
<span class="kn">import</span> <span class="nn">xarray</span>
<span class="kn">import</span> <span class="nn">networkx</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">tropycal</span>

<span class="kn">import</span> <span class="nn">tropycal.tracks</span> <span class="k">as</span> <span class="nn">tracks</span>
<span class="kn">import</span> <span class="nn">tropycal.tornado</span> <span class="k">as</span> <span class="nn">tornado</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.api</span> <span class="kn">import</span> <span class="n">OLS</span>

<span class="c1"># Modelos para Testes Futuros de Regressão</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegressionCV</span>
<span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>
<span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="kn">import</span> <span class="n">QuadraticDiscriminantAnalysis</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gamma</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">scatter_matrix</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="c1">#from sklearn.naive_bayes import GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GroupShuffleSplit</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GroupKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_friedman2</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process</span> <span class="kn">import</span> <span class="n">GaussianProcessRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process.kernels</span> <span class="kn">import</span> <span class="n">DotProduct</span><span class="p">,</span> <span class="n">WhiteKernel</span>
</code></pre></div>


<h1 id="carregamento-e-preparacao-dos-dados">Carregamento e Preparação dos Dados</h1>
<div class="codehilite"><pre><span></span><code><span class="c1">#Importação dos dados previamente estruturados</span>
<span class="n">data_atl_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Datasets/data_atl_merged2.csv&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">data_atl_merged</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">data_atl_merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">Index([&#39;ID&#39;, &#39;Name&#39;, &#39;Date&#39;, &#39;Time&#39;, &#39;Event&#39;, &#39;Status&#39;, &#39;Latitude&#39;,</span>
<span class="err">       &#39;Longitude&#39;, &#39;Maximum Wind&#39;, &#39;Minimum Pressure&#39;, &#39;Date_c&#39;, &#39;Year&#39;,</span>
<span class="err">       &#39;Month&#39;, &#39;Day&#39;, &#39;Latitude_c&#39;, &#39;Longitude_c&#39;, &#39;Duration&#39;, &#39;sst&#39;, &#39;rhum&#39;,</span>
<span class="err">       &#39;wspd&#39;, &#39;slp&#39;, &#39;cldc&#39;],</span>
<span class="err">      dtype=&#39;object&#39;)</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Date</th>
      <th>Time</th>
      <th>Event</th>
      <th>Status</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Maximum Wind</th>
      <th>Minimum Pressure</th>
      <th>...</th>
      <th>Month</th>
      <th>Day</th>
      <th>Latitude_c</th>
      <th>Longitude_c</th>
      <th>Duration</th>
      <th>sst</th>
      <th>rhum</th>
      <th>wspd</th>
      <th>slp</th>
      <th>cldc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-02</td>
      <td>1200</td>
      <td>NaN</td>
      <td>EX</td>
      <td>30.5</td>
      <td>-58.0</td>
      <td>50</td>
      <td>-999</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>30.5</td>
      <td>-58.0</td>
      <td>10</td>
      <td>12.371029</td>
      <td>72.457094</td>
      <td>72.457094</td>
      <td>1027.446055</td>
      <td>5.219256</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-02</td>
      <td>1800</td>
      <td>NaN</td>
      <td>EX</td>
      <td>29.9</td>
      <td>-56.8</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>29.9</td>
      <td>-56.8</td>
      <td>10</td>
      <td>16.217764</td>
      <td>80.423854</td>
      <td>80.423854</td>
      <td>1022.672978</td>
      <td>5.756614</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-03</td>
      <td>0</td>
      <td>NaN</td>
      <td>EX</td>
      <td>29.0</td>
      <td>-55.7</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>29.0</td>
      <td>-55.7</td>
      <td>10</td>
      <td>15.491124</td>
      <td>81.121590</td>
      <td>81.121590</td>
      <td>1023.151909</td>
      <td>5.782474</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-03</td>
      <td>600</td>
      <td>NaN</td>
      <td>EX</td>
      <td>27.5</td>
      <td>-54.8</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>27.5</td>
      <td>-54.8</td>
      <td>10</td>
      <td>22.268075</td>
      <td>84.264761</td>
      <td>84.264761</td>
      <td>1019.325138</td>
      <td>5.651842</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL011951</td>
      <td>UNNAMED</td>
      <td>1951-01-03</td>
      <td>1200</td>
      <td>NaN</td>
      <td>EX</td>
      <td>26.5</td>
      <td>-54.5</td>
      <td>45</td>
      <td>-999</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>26.5</td>
      <td>-54.5</td>
      <td>10</td>
      <td>22.336746</td>
      <td>84.458617</td>
      <td>84.458617</td>
      <td>1019.305866</td>
      <td>5.645406</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>

<div class="codehilite"><pre><span></span><code><span class="n">y_train_mw</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span>
<span class="n">y_train_mp</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">]</span>
<span class="n">y_train_mp</span><span class="p">[</span><span class="n">y_train_mp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">y_train_dur</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#print(y_train_rad)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="k">Index</span><span class="p">([</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;rhum&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">,</span>
       <span class="s1">&#39;cldc&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>


<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="k">input</span><span class="o">-</span><span class="mi">16</span><span class="o">-</span><span class="mi">44</span><span class="n">f50b930158</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span> <span class="n">SettingWithCopyWarning</span><span class="p">:</span> 
<span class="n">A</span> <span class="n">value</span> <span class="k">is</span> <span class="n">trying</span> <span class="k">to</span> <span class="n">be</span> <span class="k">set</span> <span class="k">on</span> <span class="n">a</span> <span class="k">copy</span> <span class="k">of</span> <span class="n">a</span> <span class="n">slice</span> <span class="k">from</span> <span class="n">a</span> <span class="n">DataFrame</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="k">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="p">.</span><span class="n">pydata</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="k">stable</span><span class="o">/</span><span class="n">user_guide</span><span class="o">/</span><span class="n">indexing</span><span class="p">.</span><span class="n">html</span><span class="o">#</span><span class="n">returning</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="k">view</span><span class="o">-</span><span class="n">versus</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="k">copy</span>
  <span class="n">y_train_mp</span><span class="p">[</span><span class="n">y_train_mp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Year</th>
      <th>Month</th>
      <th>sst</th>
      <th>rhum</th>
      <th>wspd</th>
      <th>slp</th>
      <th>cldc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>30.5</td>
      <td>-58.0</td>
      <td>1951</td>
      <td>1</td>
      <td>12.371029</td>
      <td>72.457094</td>
      <td>72.457094</td>
      <td>1027.446055</td>
      <td>5.219256</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29.9</td>
      <td>-56.8</td>
      <td>1951</td>
      <td>1</td>
      <td>16.217764</td>
      <td>80.423854</td>
      <td>80.423854</td>
      <td>1022.672978</td>
      <td>5.756614</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29.0</td>
      <td>-55.7</td>
      <td>1951</td>
      <td>1</td>
      <td>15.491124</td>
      <td>81.121590</td>
      <td>81.121590</td>
      <td>1023.151909</td>
      <td>5.782474</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27.5</td>
      <td>-54.8</td>
      <td>1951</td>
      <td>1</td>
      <td>22.268075</td>
      <td>84.264761</td>
      <td>84.264761</td>
      <td>1019.325138</td>
      <td>5.651842</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26.5</td>
      <td>-54.5</td>
      <td>1951</td>
      <td>1</td>
      <td>22.336746</td>
      <td>84.458617</td>
      <td>84.458617</td>
      <td>1019.305866</td>
      <td>5.645406</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="modelos">Modelos</h2>
<div class="codehilite"><pre><span></span><code><span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train_mw</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>
<span class="c1">#r2_test = 1 - ((OLSModel.predict(X_test2)-y_test)*(OLSModel.predict(X_test2)-y_test)).sum() / ((y_test.mean()-y_test)*(y_test.mean()-y_test)).sum()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#print(f&#39;R^2_test  = {r2_test}&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_const  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Year  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Month  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Latitude  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Longitude  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_sst  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_rhum  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_wspd  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_slp  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_cldc  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.02385621171100183</span>
<span class="err">Parâmetro_const  = 47.35464784180999</span>
<span class="err">Parâmetro_Year  = 0.09050506606867095</span>
<span class="err">Parâmetro_Month  = -0.05872870746380546</span>
<span class="err">Parâmetro_Latitude  = -0.08576970286238517</span>
<span class="err">Parâmetro_Longitude  = 1.880119707824508</span>
<span class="err">Parâmetro_sst  = 0.15179194438994867</span>
<span class="err">Parâmetro_rhum  = 0.028283243122749335</span>
<span class="err">Parâmetro_wspd  = 0.028283243122749446</span>
<span class="err">Parâmetro_slp  = 0.14971356534654948</span>
<span class="err">Parâmetro_cldc  = -1.5161434590996923</span>
</code></pre></div>


<p>Os códigos abaixos nos geras uma visualização que pode trazer insights a respeito da relação entre as variáveis. A escolha das variáveis preditoras que servem de entrada para os modelos mais a frente foram pensadas também pela observação destes gráficos.</p>
<div class="codehilite"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">y_train_mp</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">scatter_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">diagonal</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">);</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_13_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># A princípio, não queremos que se faça alguma previsão com base no valor numérico do ano</span>
<span class="c1"># Além disso, a variável wspd está altamente correlacionada com a rhum, podendo ser mantida apenas a última</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">#   Mês      Latitude    Longitude    Temperatura, Umidade, Sea Level Pressure, Cloudiness]</span>
<span class="c1"># [&#39;Month&#39;, &#39;Latitude&#39;, &#39;Longitude&#39;, &#39;sst&#39;,       &#39;rhum&#39;,  &#39;slp&#39;,              &#39;cldc&#39;]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Velocidade Máxima vs Variáveis Preditoras (1950-2015)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.06</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;rhum&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;slp&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;cldc&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="c1">#ax.plot([1850, 2015], [w0, w1], ls = &#39;-.&#39;) #, label=r&#39;$Furacões$ $=$ $0$&#39;)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">ax.tick_params(labelsize=24)</span>
<span class="sd">ax.set_title(f&#39;Número de Furacões Anuais (1851-2015)&#39;, fontsize=24)</span>
<span class="sd">ax.set_xlabel(r&#39;$Ano$&#39;, fontsize=16)</span>
<span class="sd">ax.set_ylabel(r&#39;$Quantidade$&#39;, fontsize=16)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1">#fig.legend(loc=&#39;best&#39;, fontsize=12);</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_15_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">Latitude       27.466819</span>
<span class="err">Longitude     -62.607058</span>
<span class="err">Month           8.709729</span>
<span class="err">sst            26.416134</span>
<span class="err">rhum           81.284651</span>
<span class="err">slp          1009.678574</span>
<span class="err">cldc            5.137222</span>
<span class="c">dtype: float64</span>
</code></pre></div>


<p>Uma primeira tentativa de ajuste foi feito através da centralização das variáveis preditoras em relação à média, adicionando também termos polinomiais de segunda ordem. No entanto, os resultados do ajuste não mostraram ganhos significativos para o modelo de Regressão Linear Múltipla, e até prejudicaram modelos mais complexos, como Random Forest, Multi Layer Perceptron, entre outros utilizados mais a frente.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Tentativa de ajuste através de transformação de variáveis e inclusão de termos polinomiais</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Month_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">8.788781</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Latitude_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">17.943038</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Longitude_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">62.555538</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">28.888685</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;rhum_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;rhum&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">82.051702</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;slp_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;slp&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1008.611661</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;cldc_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;cldc&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">5.223518</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Month_mod^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Month_mod&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Latitude_mod^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Latitude_mod&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Longitude_mod^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;Longitude_mod&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst_mod^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst_mod&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;rhum_mod^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;rhum_mod&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;slp_mod^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;slp_mod&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;cldc_mod^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;cldc_mod&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;rhum&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">,</span> <span class="s1">&#39;cldc&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month_mod</th>
      <th>Latitude_mod</th>
      <th>Longitude_mod</th>
      <th>sst_mod</th>
      <th>rhum_mod</th>
      <th>slp_mod</th>
      <th>cldc_mod</th>
      <th>Month_mod^2</th>
      <th>Latitude_mod^2</th>
      <th>Longitude_mod^2</th>
      <th>sst_mod^2</th>
      <th>rhum_mod^2</th>
      <th>slp_mod^2</th>
      <th>cldc_mod^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-7.788781</td>
      <td>12.556962</td>
      <td>4.555538</td>
      <td>-16.517656</td>
      <td>-9.594608</td>
      <td>18.834394</td>
      <td>-0.004262</td>
      <td>60.665109</td>
      <td>157.677295</td>
      <td>20.752926</td>
      <td>272.832952</td>
      <td>92.056509</td>
      <td>354.734396</td>
      <td>0.000018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-7.788781</td>
      <td>11.956962</td>
      <td>5.755538</td>
      <td>-12.670921</td>
      <td>-1.627848</td>
      <td>14.061317</td>
      <td>0.533096</td>
      <td>60.665109</td>
      <td>142.968940</td>
      <td>33.126218</td>
      <td>160.552231</td>
      <td>2.649888</td>
      <td>197.720622</td>
      <td>0.284192</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-7.788781</td>
      <td>11.056962</td>
      <td>6.855538</td>
      <td>-13.397561</td>
      <td>-0.930112</td>
      <td>14.540248</td>
      <td>0.558956</td>
      <td>60.665109</td>
      <td>122.256409</td>
      <td>46.998401</td>
      <td>179.494647</td>
      <td>0.865108</td>
      <td>211.418806</td>
      <td>0.312431</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-7.788781</td>
      <td>9.556962</td>
      <td>7.755538</td>
      <td>-6.620610</td>
      <td>2.213059</td>
      <td>10.713477</td>
      <td>0.428324</td>
      <td>60.665109</td>
      <td>91.335523</td>
      <td>60.148370</td>
      <td>43.832480</td>
      <td>4.897629</td>
      <td>114.778588</td>
      <td>0.183461</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-7.788781</td>
      <td>8.556962</td>
      <td>8.055538</td>
      <td>-6.551939</td>
      <td>2.406915</td>
      <td>10.694205</td>
      <td>0.421888</td>
      <td>60.665109</td>
      <td>73.221599</td>
      <td>64.891692</td>
      <td>42.927902</td>
      <td>5.793238</td>
      <td>114.366028</td>
      <td>0.177989</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="regressao-linear">Regressão Linear</h3>
<div class="codehilite"><pre><span></span><code><span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train_mw</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>
<span class="c1">#r2_test = 1 - ((OLSModel.predict(X_test2)-y_test)*(OLSModel.predict(X_test2)-y_test)).sum() / ((y_test.mean()-y_test)*(y_test.mean()-y_test)).sum()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#print(f&#39;R^2_test  = {r2_test}&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_const  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Month  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Latitude  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Longitude  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_sst  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_rhum  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_slp  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_cldc  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Month^2  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Latitude^2  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_Longitude^2  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_sst^2  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_rhum^2  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_slp^2  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parâmetro_cldc^2  = </span><span class="si">{</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">R^2_train = 0.057796565423244184</span>
<span class="err">Parâmetro_const  = 55.44314399378881</span>
<span class="err">Parâmetro_Month  = 0.8453623447457261</span>
<span class="err">Parâmetro_Latitude  = 0.3457362098822069</span>
<span class="err">Parâmetro_Longitude  = -0.02891517619557605</span>
<span class="err">Parâmetro_sst  = 0.02964116885731194</span>
<span class="err">Parâmetro_rhum  = 0.09964668732077198</span>
<span class="err">Parâmetro_slp  = 0.289107953297979</span>
<span class="err">Parâmetro_cldc  = -0.5559643046414668</span>
<span class="err">Parâmetro_Month^2  = -0.48473747846473236</span>
<span class="err">Parâmetro_Latitude^2  = -0.017728720785750357</span>
<span class="err">Parâmetro_Longitude^2  = -0.00855022784566639</span>
<span class="err">Parâmetro_sst^2  = 0.051566532947100174</span>
<span class="err">Parâmetro_rhum^2  = 0.002209669018392528</span>
<span class="err">Parâmetro_slp^2  = -0.03379242085061111</span>
<span class="err">Parâmetro_cldc^2  = -0.16931736469014314</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_train_mw</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">y_test_mw</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">16789</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Month</th>
      <th>sst</th>
      <th>rhum</th>
      <th>slp</th>
      <th>cldc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10353</th>
      <td>26.2</td>
      <td>-78.2</td>
      <td>8</td>
      <td>28.981304</td>
      <td>82.394811</td>
      <td>1006.801278</td>
      <td>4.477195</td>
    </tr>
    <tr>
      <th>19374</th>
      <td>14.5</td>
      <td>-69.6</td>
      <td>10</td>
      <td>28.904502</td>
      <td>82.054564</td>
      <td>1010.190954</td>
      <td>5.367316</td>
    </tr>
    <tr>
      <th>12393</th>
      <td>30.7</td>
      <td>-86.3</td>
      <td>7</td>
      <td>28.347659</td>
      <td>82.523253</td>
      <td>1000.820020</td>
      <td>6.652682</td>
    </tr>
    <tr>
      <th>3373</th>
      <td>40.9</td>
      <td>-70.7</td>
      <td>9</td>
      <td>24.981041</td>
      <td>77.434502</td>
      <td>1012.284426</td>
      <td>4.131097</td>
    </tr>
    <tr>
      <th>21173</th>
      <td>25.8</td>
      <td>-42.5</td>
      <td>9</td>
      <td>28.643885</td>
      <td>78.809962</td>
      <td>1013.124650</td>
      <td>4.610140</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="random-forest">Random Forest</h3>
<p>Primeira tentativa de ajuste já nos parece promissor em relação aos demais.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#X_train, y_train_mw = make_regression(n_features=7, n_informative=2, random_state=0, shuffle=False)</span>
<span class="n">regr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.8272253680614361</span>
<span class="err">0.4358801020027704</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">#X_train = data_atl_merged.drop([&#39;ID&#39;, &#39;Name&#39;, &#39;Date&#39;, &#39;Time&#39;, &#39;Event&#39;, &#39;Status&#39;, &#39;Maximum Wind&#39;, &#39;Minimum Pressure&#39;, &#39;Date_c&#39;, &#39;Day&#39;, &#39;Latitude_c&#39;, &#39;Longitude_c&#39;, &#39;Duration&#39;, &#39;Year&#39;, &#39;wspd&#39;], 1)</span>
<span class="c1">#X_train.head()</span>
</code></pre></div>


<h3 id="multi-layer-perceptron">Multi Layer Perceptron</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">#X_train, y_train_mw = make_regression(n_samples=200, random_state=1)</span>
<span class="n">regr</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="c1">#regr.predict(X_test[:2])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="mi">0</span><span class="p">.</span><span class="mi">09520915346048042</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">08725614810614979</span>


<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">gambitura</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">neural_network</span><span class="o">/</span><span class="n">_multilayer_perceptron</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">471</span><span class="p">:</span> <span class="n">ConvergenceWarning</span><span class="p">:</span> <span class="n">lbfgs</span> <span class="n">failed</span> <span class="k">to</span> <span class="n">converge</span> <span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="n">STOP</span><span class="p">:</span> <span class="n">TOTAL</span> <span class="k">NO</span><span class="p">.</span> <span class="k">of</span> <span class="n">ITERATIONS</span> <span class="n">REACHED</span> <span class="k">LIMIT</span><span class="p">.</span>

<span class="n">Increase</span> <span class="n">the</span> <span class="nb">number</span> <span class="k">of</span> <span class="n">iterations</span> <span class="p">(</span><span class="n">max_iter</span><span class="p">)</span> <span class="k">or</span> <span class="k">scale</span> <span class="n">the</span> <span class="k">data</span> <span class="k">as</span> <span class="n">shown</span> <span class="k">in</span><span class="p">:</span>
    <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">scikit</span><span class="o">-</span><span class="n">learn</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="k">stable</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">preprocessing</span><span class="p">.</span><span class="n">html</span>
  <span class="k">self</span><span class="p">.</span><span class="n">n_iter_</span> <span class="o">=</span> <span class="n">_check_optimize_result</span><span class="p">(</span><span class="ss">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">opt_res</span><span class="p">,</span> <span class="k">self</span><span class="p">.</span><span class="n">max_iter</span><span class="p">)</span>
</code></pre></div>


<h2 id="modelos-com-separacao-em-conjuntos-de-treino-e-teste">Modelos com Separação em Conjuntos de Treino e Teste</h2>
<p>Separamos os dados em conjuntos de treino e de teste. Deste modo, podemos ajustar o algoritmo utilizando os dados de treino, e tentar utilizar esses dados de teste para previsão de outros dados, inclusive futuros.</p>
<div class="codehilite"><pre><span></span><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_train_mw</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span>
<span class="c1">#print(len(X_train))</span>
<span class="c1">#X_train.head()</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">y_test_mw</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<h3 id="regressao-linear_1">Regressão Linear</h3>
<div class="codehilite"><pre><span></span><code><span class="n">X_train2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">X_test2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> <span class="c1">#np.array(X_train).reshape(X_train.shape[0],1)</span>
<span class="n">OLS_obj</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y_train_mw</span><span class="p">,</span> <span class="n">X_train2</span><span class="p">)</span>
<span class="n">OLSModel</span> <span class="o">=</span> <span class="n">OLS_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">r2_train</span> <span class="o">=</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">rsquared</span>
<span class="n">r2_test</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test2</span><span class="p">)</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OLSModel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test2</span><span class="p">)</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">((</span><span class="n">y_test_mw</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y_test_mw</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">y_test_mw</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_train = </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R^2_test  = </span><span class="si">{</span><span class="n">r2_test</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">print(f&#39;Parâmetro_const  = {OLSModel.params[0]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Month  = {OLSModel.params[1]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Latitude  = {OLSModel.params[2]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Longitude  = {OLSModel.params[3]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_sst  = {OLSModel.params[4]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_rhum  = {OLSModel.params[5]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_slp  = {OLSModel.params[6]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_cldc  = {OLSModel.params[7]}&#39;)</span>

<span class="sd">print(f&#39;Parâmetro_Month^2  = {OLSModel.params[8]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Latitude^2  = {OLSModel.params[9]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_Longitude^2  = {OLSModel.params[10]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_sst^2  = {OLSModel.params[11]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_rhum^2  = {OLSModel.params[12]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_slp^2  = {OLSModel.params[13]}&#39;)</span>
<span class="sd">print(f&#39;Parâmetro_cldc^2  = {OLSModel.params[14]}&#39;)</span>
<span class="sd">&#39;&#39;&#39;</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">R</span><span class="o">^</span><span class="mi">2</span><span class="n">_train</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">019806236602926464</span>
<span class="n">R</span><span class="o">^</span><span class="mi">2</span><span class="n">_test</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01874952522766249</span>





<span class="ss">&quot;\nprint(f&#39;Parâmetro_const  = {OLSModel.params[0]}&#39;)\nprint(f&#39;Parâmetro_Month  = {OLSModel.params[1]}&#39;)\nprint(f&#39;Parâmetro_Latitude  = {OLSModel.params[2]}&#39;)\nprint(f&#39;Parâmetro_Longitude  = {OLSModel.params[3]}&#39;)\nprint(f&#39;Parâmetro_sst  = {OLSModel.params[4]}&#39;)\nprint(f&#39;Parâmetro_rhum  = {OLSModel.params[5]}&#39;)\nprint(f&#39;Parâmetro_slp  = {OLSModel.params[6]}&#39;)\nprint(f&#39;Parâmetro_cldc  = {OLSModel.params[7]}&#39;)\n\nprint(f&#39;Parâmetro_Month^2  = {OLSModel.params[8]}&#39;)\nprint(f&#39;Parâmetro_Latitude^2  = {OLSModel.params[9]}&#39;)\nprint(f&#39;Parâmetro_Longitude^2  = {OLSModel.params[10]}&#39;)\nprint(f&#39;Parâmetro_sst^2  = {OLSModel.params[11]}&#39;)\nprint(f&#39;Parâmetro_rhum^2  = {OLSModel.params[12]}&#39;)\nprint(f&#39;Parâmetro_slp^2  = {OLSModel.params[13]}&#39;)\nprint(f&#39;Parâmetro_cldc^2  = {OLSModel.params[14]}&#39;)\n&quot;</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="c1">#fig.suptitle(&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;, fontsize=28, y=1.06)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Treino$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train2</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">y_test_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Teste$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">OLSModel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test2</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Regressão Linear (Treino)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Regressão Linear (Teste)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_34_0.png" /></p>
<h3 id="random-forest_1">Random Forest</h3>
<p>Pelos ajustes anteriores, vimos que esse algoritmo promove um bom ajuste nos dados. Um novo ajuste com aplicação de parâmetros melhor sintonizados com os dados é buscado pelo código abaixo.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Parâmetros com bom ajuste para Random Forest: n_estimators = 50, max_depth = 75</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">]:</span>
        <span class="n">regr_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">regr_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> n_estimators=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">, max_depth=</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">regr_rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">regr_rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9109127406378082</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5049385543175804</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9231191839999706</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5083859136052509</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9231191839999706</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5083859136052509</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9231191839999706</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5083859136052509</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9231191839999706</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5083859136052509</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9177312843005485</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5190516352697632</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9298001112559356</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5227899508473133</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9298001112559356</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5227899508473133</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9298001112559356</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5227899508473133</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9298001112559356</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5227899508473133</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9198026089627763</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5227499387064152</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9323017737677339</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5256624725114608</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9323017737677339</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5256624725114608</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9323017737677339</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5256624725114608</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9323017737677339</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5256624725114608</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9198383784088979</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5224954900261807</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9336736647334395</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5269361337556209</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9336736647334395</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5269361337556209</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9336736647334395</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5269361337556209</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9336736647334395</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5269361337556209</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9204444093451314</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5234545174002654</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9344355008748928</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5280216690661794</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9344355008748928</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5280216690661794</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9344355008748928</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5280216690661794</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9344355008748928</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">5280216690661794</span>
</code></pre></div>


<p>O R2 Score obtido abaixo mostra o melhor ajuste do modelo quando tentamos prever a Velocidade Máxima Sustentada pelo algoritmo do Random Forest. O ajuste aos dados de treino ficam</p>
<div class="codehilite"><pre><span></span><code><span class="n">regr_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.9298001112559356</span>
<span class="err">0.5227899508473133</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">X_train_red</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;rhum&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">,</span> <span class="s1">&#39;cldc&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_test_red</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;rhum&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">,</span> <span class="s1">&#39;cldc&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<p>Retirando os dados climáticos, observamos que o ajuste fica bem pior, mostrando a importância dos mesmos para a predição</p>
<div class="codehilite"><pre><span></span><code><span class="n">regr_rf_red</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf_red</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_red</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_red</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_red</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_red</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_red</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.8598571752407663</span>
<span class="err">0.06143697855472363</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">X_train_red</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_test_red</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">regr_rf_red</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf_red</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_red</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_red</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_red</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_red</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_red</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.9072010288584739</span>
<span class="err">0.3833348196160016</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1">#[&#39;Month&#39;, &#39;Latitude&#39;, &#39;Longitude&#39;, &#39;sst&#39;, &#39;rhum&#39;, &#39;slp&#39;, &#39;cldc&#39;]</span>
<span class="n">X_train_red</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_test_red</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">regr_rf_red</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf_red</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_red</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_red</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_red</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_red</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_red</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.9230537875398801</span>
<span class="err">0.4840455607978509</span>
</code></pre></div>


<p>Ajuste da predição em relação à variável sst (temperatura mensal média)</p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="c1">#fig.suptitle(&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;, fontsize=28, y=1.06)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Treino$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">regr_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">y_test_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Teste$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">regr_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Random Forest (Treino)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Random Forest (Teste)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_48_0.png" /></p>
<h3 id="demais-previsoes-com-random-forest-melhor-ajuste">Demais Previsões com Random Forest (Melhor Ajuste)</h3>
<p>Adicionando as variáveis Ano e Dia, conseguimos melhorar significativamente a capacidade de previsão do nosso modelo.
Se adicionarmos primeiramente apenas a variável Ano, percebemos que cada variável contribui um pouco para a melhoria da previsão.</p>
<div class="codehilite"><pre><span></span><code><span class="n">data_train_sd</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_train_mw_sd</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span>
<span class="c1">#print(len(data_train))</span>
<span class="c1">#data_train.head()</span>
<span class="n">data_train_sd</span><span class="p">,</span> <span class="n">data_test_sd</span><span class="p">,</span> <span class="n">data_train_mw_sd</span><span class="p">,</span> <span class="n">data_test_mw_sd</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_train_sd</span><span class="p">,</span> <span class="n">data_train_mw_sd</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">regr_rf2_sd</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf2_sd</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train_sd</span><span class="p">,</span> <span class="n">data_train_mw_sd</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2_sd</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_train_sd</span><span class="p">,</span> <span class="n">data_train_mw_sd</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2_sd</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test_sd</span><span class="p">,</span> <span class="n">data_test_mw_sd</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.9502630426894276</span>
<span class="err">0.6609429559863542</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data_train</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_train_mw</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">]</span>
<span class="c1">#print(len(data_train))</span>
<span class="c1">#data_train.head()</span>
<span class="n">data_train</span><span class="p">,</span> <span class="n">data_test</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">,</span> <span class="n">data_test_mw</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<p>Ajuste fino dos parâmetros do Random Forest</p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">]:</span>
        <span class="n">regr_rf2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">regr_rf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> n_estimators=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">, max_depth=</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test</span><span class="p">,</span> <span class="n">data_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">957264562824329</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7444676687346707</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9582917968925033</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7442935073801389</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9582917968925033</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7442935073801389</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9582917968925033</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7442935073801389</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9582917968925033</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7442935073801389</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9617003376388379</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7583441990969142</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9629951225598822</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7593567448937373</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9629951225598822</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7593567448937373</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9629951225598822</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7593567448937373</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9629951225598822</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7593567448937373</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9637876668338223</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7615184996888411</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9651229272756359</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7623946732426374</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9651229272756359</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7623946732426374</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9651229272756359</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7623946732426374</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9651229272756359</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7623946732426374</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9643667689055675</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7618762745120209</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9657927394363737</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7630103360785616</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9657927394363737</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7630103360785616</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9657927394363737</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7630103360785616</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9657927394363737</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7630103360785616</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">25</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9647081307547872</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">762938280257875</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9661419630929642</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7643016255435418</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9661419630929642</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7643016255435418</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">100</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9661419630929642</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7643016255435418</span>

 <span class="n">n_estimators</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">9661419630929642</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">7643016255435418</span>
</code></pre></div>


<p>Melhor ajuste para Previsão de Maximal Wind</p>
<div class="codehilite"><pre><span></span><code><span class="n">regr_rf2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test</span><span class="p">,</span> <span class="n">data_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.9629951225598822</span>
<span class="err">0.7593567448937373</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="c1">#fig.suptitle(&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;, fontsize=28, y=1.06)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">data_train_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Treino$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">regr_rf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_train</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">data_test_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Teste$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">regr_rf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_test</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Random Forest (Treino)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Random Forest (Teste)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_58_0.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="c1">#fig.suptitle(&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;, fontsize=28, y=1.06)</span>
<span class="n">data_concat_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data_concat_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_test</span><span class="p">,</span> <span class="n">data_test_mw</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_train</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">data_concat_train</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Treino$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_train</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">regr_rf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_train</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_test</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">data_concat_test</span><span class="p">[</span><span class="s1">&#39;Maximum Wind&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Teste$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_test</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">regr_rf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_test</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Random Forest (Treino)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por Random Forest (Teste)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_59_0.png" /></p>
<h3 id="previsao-da-duracao-dos-eventos-de-furacao">Previsão da duração dos eventos de Furacão</h3>
<div class="codehilite"><pre><span></span><code><span class="n">data_train2</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum Wind&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Date_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_c&#39;</span><span class="p">,</span> <span class="s1">&#39;Duration&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#data_train_mw = data_atl_merged[&#39;Maximum Wind&#39;]</span>
<span class="n">data_train_dur</span> <span class="o">=</span> <span class="n">data_atl_merged</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">]</span>
<span class="c1">#print(len(data_train))</span>
<span class="c1">#data_train.head()</span>
<span class="n">data_train2</span><span class="p">,</span> <span class="n">data_test2</span><span class="p">,</span> <span class="n">data_train_dur</span><span class="p">,</span> <span class="n">data_test_dur</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_train2</span><span class="p">,</span> <span class="n">data_train_dur</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<p>Abaixo, faremos também a previsão da duração de um Furacão. O ajuste fica bem preciso, como se pode ver pelo R2 Score</p>
<div class="codehilite"><pre><span></span><code><span class="n">regr_rf3</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train2</span><span class="p">,</span> <span class="n">data_train_dur</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf3</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_train2</span><span class="p">,</span> <span class="n">data_train_dur</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf3</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test2</span><span class="p">,</span> <span class="n">data_test_dur</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.9883397102866289</span>
<span class="err">0.9289716458290775</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="c1">#fig.suptitle(&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;, fontsize=28, y=1.06)</span>
<span class="n">data_concat_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_train</span><span class="p">,</span> <span class="n">data_train_mw</span><span class="p">,</span> <span class="n">data_train_dur</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data_concat_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_test</span><span class="p">,</span> <span class="n">data_test_mw</span><span class="p">,</span> <span class="n">data_test_dur</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_train</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">data_concat_train</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Treino$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_train</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">regr_rf3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_train2</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_test</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">data_concat_test</span><span class="p">[</span><span class="s1">&#39;Duration&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Teste$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_concat_test</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">regr_rf3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_test2</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão da Duração por Random Forest (Treino)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Duração$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão da Duração por Random Forest (Teste)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Ano$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Duração$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_64_0.png" /></p>
<h3 id="multi-layer-perceptron_1">Multi Layer Perceptron</h3>
<div class="codehilite"><pre><span></span><code><span class="n">regr_mlp</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="c1">#regr.predict(X_test[:2])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_mlp</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_mlp</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">gambitura</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">neural_network</span><span class="o">/</span><span class="n">_multilayer_perceptron</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">471</span><span class="p">:</span> <span class="n">ConvergenceWarning</span><span class="p">:</span> <span class="n">lbfgs</span> <span class="n">failed</span> <span class="k">to</span> <span class="n">converge</span> <span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="n">STOP</span><span class="p">:</span> <span class="n">TOTAL</span> <span class="k">NO</span><span class="p">.</span> <span class="k">of</span> <span class="n">ITERATIONS</span> <span class="n">REACHED</span> <span class="k">LIMIT</span><span class="p">.</span>

<span class="n">Increase</span> <span class="n">the</span> <span class="nb">number</span> <span class="k">of</span> <span class="n">iterations</span> <span class="p">(</span><span class="n">max_iter</span><span class="p">)</span> <span class="k">or</span> <span class="k">scale</span> <span class="n">the</span> <span class="k">data</span> <span class="k">as</span> <span class="n">shown</span> <span class="k">in</span><span class="p">:</span>
    <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">scikit</span><span class="o">-</span><span class="n">learn</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="k">stable</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">preprocessing</span><span class="p">.</span><span class="n">html</span>
  <span class="k">self</span><span class="p">.</span><span class="n">n_iter_</span> <span class="o">=</span> <span class="n">_check_optimize_result</span><span class="p">(</span><span class="ss">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">opt_res</span><span class="p">,</span> <span class="k">self</span><span class="p">.</span><span class="n">max_iter</span><span class="p">)</span>


<span class="mi">0</span><span class="p">.</span><span class="mi">09520915346048042</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">08725614810614979</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c1">#, figsize=(16,10))</span>
<span class="c1">#fig.suptitle(&#39;Velocidade Máxima vs Pressão Mínima (1851-2015)&#39;, fontsize=28, y=1.06)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">y_train_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Treino$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">regr_mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">y_test_mw</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Dados$ $de$ $Teste$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">],</span> <span class="n">regr_mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Previsão$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por MLPRegressor (Treino)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Previsão de Maximal Wind por MLPRegressor (Teste)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$sst$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Maximal$ $Wind$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


<p><img alt="png" src="../Analises_variaveis_files/Analises_variaveis_67_0.png" /></p>
<h3 id="support-vector-machine">Support Vector Machine</h3>
<div class="codehilite"><pre><span></span><code><span class="n">regr_svr</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVR</span><span class="p">()</span>
<span class="n">regr_svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">-0.06514630260669341</span>
<span class="err">-0.058505019763586796</span>
</code></pre></div>


<h3 id="modelos-com-escala-padronizada">Modelos com Escala Padronizada</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Padronização da Escala</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="n">X_train_std</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="n">X_test_std</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">regr_svr_std</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVR</span><span class="p">()</span>
<span class="n">regr_svr_std</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_std</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_svr_std</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_std</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_svr_std</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_std</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.07772469466765619</span>
<span class="err">0.07604328404370786</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">regr_mlp_std</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="c1">#regr.predict(X_test[:2])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_mlp_std</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_std</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_mlp_std</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_std</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">gambitura</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">neural_network</span><span class="o">/</span><span class="n">_multilayer_perceptron</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">471</span><span class="p">:</span> <span class="n">ConvergenceWarning</span><span class="p">:</span> <span class="n">lbfgs</span> <span class="n">failed</span> <span class="k">to</span> <span class="n">converge</span> <span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="n">STOP</span><span class="p">:</span> <span class="n">TOTAL</span> <span class="k">NO</span><span class="p">.</span> <span class="k">of</span> <span class="n">ITERATIONS</span> <span class="n">REACHED</span> <span class="k">LIMIT</span><span class="p">.</span>

<span class="n">Increase</span> <span class="n">the</span> <span class="nb">number</span> <span class="k">of</span> <span class="n">iterations</span> <span class="p">(</span><span class="n">max_iter</span><span class="p">)</span> <span class="k">or</span> <span class="k">scale</span> <span class="n">the</span> <span class="k">data</span> <span class="k">as</span> <span class="n">shown</span> <span class="k">in</span><span class="p">:</span>
    <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">scikit</span><span class="o">-</span><span class="n">learn</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="k">stable</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">preprocessing</span><span class="p">.</span><span class="n">html</span>
  <span class="k">self</span><span class="p">.</span><span class="n">n_iter_</span> <span class="o">=</span> <span class="n">_check_optimize_result</span><span class="p">(</span><span class="ss">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">opt_res</span><span class="p">,</span> <span class="k">self</span><span class="p">.</span><span class="n">max_iter</span><span class="p">)</span>


<span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">16270156850149</span>
<span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">153096948726193</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">regr_rf_std</span><span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">regr_rf_std</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_std</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_std</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_std</span><span class="p">,</span> <span class="n">y_train_mw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regr_rf_std</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_std</span><span class="p">,</span> <span class="n">y_test_mw</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">0.9298162379440262</span>
<span class="err">0.5220914993160997</span>
</code></pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../PowerDissipationIndex/" class="btn btn-neutral float-right" title="Destrutividade no longo prazo">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Data_Cleaning_and_EDA/" class="btn btn-neutral" title="Data Cleaning + EDA"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Data_Cleaning_and_EDA/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../PowerDissipationIndex/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
